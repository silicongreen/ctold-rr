<div id="page-yield" class="available_sections">
    <div style="margin: 0 auto;">
        <center>
            <div style="width:800px;
                 background: #333333;
                 height: 1px;
                 margin-top:-10px;
                 float:left;"></div>
                 <% if @financefee.is_paid %>
              <h2 style="margin-bottom: 2px;font-weight: normal;"><%= t('fee_reciept') %></h2>
            <% else %>
              <h2 style="margin-bottom: 2px;font-weight: normal;"><%= t('partial_payment_receipt') %></h2>
            <% end %>
            <div style="width:800px;
                 background: #333333;
                 height: 1px;
                 margin-top:-10px;
                 float:left;"></div>
            <div class="extender"> </div>
        </center>
        <% total_fees = 0 %>
        <div style="text-align: left !important;">
            <div style="width:45%;float:left;">
                <h4  style="color: #555555;margin-top: 18px;font-weight: bold;" style="width:505px;"> <%= "#{t('name')}: #{@student.full_name}" %></h4>
                <h4  style="color: #555555;margin-top: 18px;font-weight: bold;" style="width:505px;"> <%= "#{t('admission_no')} : #{@student.admission_no}" %></h4>
                <h4  style="color: #555555;margin-top: 18px;font-weight: bold;" style="width:505px;"> <%= "#{t('course_text')} : #{@student.batch.course.course_name}" %></h4>
                <h4  style="color: #555555;margin-top: 18px;font-weight: bold;" style="width:505px;"> <%= "#{t('batch')} : #{@student.batch.full_name}" %></h4>
            </div>
            <div style="float:right;" >
                <h4  style="color: #555555;margin-top: 18px;font-weight: bold;" > <%= "#{t('fees_collection_date_name')}: #{@date.name.capitalize}" %> </h4>
            </div>
        </div>
    </div>
    <div style="margin: 0 auto;" >
        <table style="border: 1px solid #ADACAB;border-collapse:collapse;" width="100%" cellspacing="0">
            <tr style="border: 1px solid #ADACAB;" class="table-header">
                <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="mark-td"><%= t('sl_no') %></td>
                <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="name-td"><%= t('particulars') %></td>
                <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="mark-td"> <%= "#{t('amount')}(#{@currency_type.to_s})" %></td>
            </tr>
            <%k=7%>
            <% i = 0  %>
            <% c= 'even' %>
            <% @fee_particulars.each do |fee| %>
              <tr style="border: 1px solid #ADACAB;" class="<%= cycle(c,(["odd","even"]-[c]).first) %>">
                  <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="mark-td"><%= i+=1 %></td>
                  <%k+=1%>
                  <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="name-td"><%= fee.name %></td>
                  <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="mark-td">&nbsp;<%= "#{precision_label(fee.amount.to_s)}" %></td>
              </tr>
              <% total_fees += fee.amount %>
            <% end %>

            <% unless @total_discount == 0 %>
              <tr style="border: 1px solid #ADACAB;" class="tr-blank"></tr>
              <tr style="border: 1px solid #ADACAB;" class="tr-blank"></tr>
              <tr style="border: 1px solid #ADACAB;" class="<%= cycle(c,(["odd","even"]-[c]).first) %>">
                  <%k+=1%>
                  <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="col-1" colspan="3"><span class="space"><%= t('discount') %></span></td>
              </tr>

              <% @discounts.each do |d| %>
                <%k+=1%>
                <tr style="border: 1px solid #ADACAB;" class="<%= cycle(c,(["odd","even"]-[c]).first) %>">
                    <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="mark-td"><%= i+=1 %></td>
                    <% discount_text = d.is_amount == true ? "#{d.name}" : "#{d.name}(#{d.discount})%" %>
                    <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="name-td"><%= discount_text %></td>
                    <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="mark-td"><%= precision_label(@total_payable * d.discount.to_f/ (d.is_amount?? @total_payable : 100)) %></td>
                </tr>
              <% end %>

              <tr style="border: 1px solid #ADACAB;" class="tr-blank"></tr>
              <tr style="border: 1px solid #ADACAB;" class="tr-blank"></tr>

              <tr style="border: 1px solid #ADACAB;" class="<%= cycle(c,(["odd","even"]-[c]).first) %>">
                  <%k+=1%>
                  <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="mark-td" colspan="2" ><%= t('total_discount') %></td>
                  <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="mark-td" ><%= "#{precision_label(@total_discount)}" %></td>
              </tr>

              <tr style="border: 1px solid #ADACAB;" class="tr-blank"></tr>
              <tr style="border: 1px solid #ADACAB;" class="tr-blank"></tr>
              <% total_fees = (@total_payable-@total_discount) %>
              <tr style="border: 1px solid #ADACAB;" class="<%= cycle(c,(["odd","even"]-[c]).first) %>">
                  <%k+=1%>
                  <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="mark-td" colspan="2" ><%= t('total_fees') %></td>
                  <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="mark-td" ><%=  precision_label(total_fees) %></td>
              </tr>

              <tr style="border: 1px solid #ADACAB;" class="tr-blank"></tr>
              <tr style="border: 1px solid #ADACAB;" class="tr-blank"></tr>

            <% end %>

            <% if @paid_fees%>



              <% unless @paid_fees.blank? %>
                <% @paid_fees.each do |trans| %>
                  <% if trans.fine_included %>
                    <tr style="border: 1px solid #ADACAB;" class="<%= cycle(c,(["odd","even"]-[c]).first) %>">
                        <%k+=1%>
                        <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="col-1"><%= i+=1 %></td>
                        <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="col-2"><span><%= t('fine_on') %> <%= trans.transaction_date %></span></td>

                        <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="col-4"><%="#{precision_label(trans.fine_amount.to_f)}" %></td>
                    </tr>
                    <% total_fees += trans.fine_amount.to_f %>
                  <% end %>
                <% end %>
              <% end %>
            <%end%>
            <% unless @paid_fees.nil? %>
              <% paid=0 %>
              <% @paid_fees.each{|a| paid += a.amount.to_f} %>
              <% total_fees -= paid %>
              <tr style="border: 1px solid #ADACAB;" class="tr-blank"></tr>
              <tr style="border: 1px solid #ADACAB;" class="tr-blank"></tr>
              <%if (@fine_amount.present?) and (@financefee.balance > 0)%>
                <tr style="border: 1px solid #ADACAB;" class="<%= cycle(c,(["odd","even"]-[c]).first) %>">
                    <%k+=1%>
                    <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="col-8" colspan="2" ><%= t('fine_on') %> <%= Date.today %></td>
                    <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="col-6" ><%=precision_label(@fine_amount.to_f) %></td>
                </tr>
              <%end%>
              <tr style="border: 1px solid #ADACAB;" class="<%= cycle(c,(["odd","even"]-[c]).first) %>">
                  <%k+=1%>
                  <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="col-8" colspan="2" ><%= t('payment_done') %></td>
                  <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="col-6" ><%=precision_label(paid) %></td>
              </tr>
            <% end %>
            <%balance=@financefee.balance.to_f+@fine.to_f+@fine_amount.to_f%>
            <tr style="border: 1px solid #ADACAB;" class="<%= cycle(c,(["odd","even"]-[c]).first) %>">
                <%k+=1%>
                <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" colspan="2" class="col-8"><%= t('amount_to_pay') %></td>
                <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;" class="col-pdf"><%=precision_label(balance) %></td>
            </tr>
            <% if ((k+1)%1)==0 %>
          </table>
          </center>
      </div>
      <div style="margin-top:20px;" >
          <center>

              <table style="border: 1px solid #ADACAB;border-collapse:collapse;" width="100%" >

                <% end %>
            </table>
    </div>

    <div id="pdf-info" style="float:left;
         width:800px;">

        <%page_val=24%>
        <%k=19%>
        <% unless @paid_fees.empty? %>
          <div style="margin-top:20px;">
              <h4  style="color: #555555;margin-top: 18px;font-weight: bold;"><%= "#{t('payment_history')}"%></h4>

              <table style="border: 1px solid #ADACAB;border-collapse:collapse;" width="100%" cellspacing="0">
                  <% c= 'even' %>

                  <tr style="border: 1px solid #ADACAB;" class="table-header">
                      <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;width:10%;
                          min-width:10%;
                          max-width:10%;
                          word-break:break-all;" class="sl-td" ><%= t('sl_no') %></td>
                      <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff; width:14%;
                          min-width:14%;
                          max-width:14%;
                          word-break:break-all;" class="date-td"> <%= t('payment_date') %></td>
                      <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff; width:16%;
                          min-width:16%;
                          max-width:16%;
                          word-break:break-all;" class="rec-td"> <%= t('receipt_no') %></td>
                      <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;width:15%;
                          min-width:15%;
                          max-width:15%;
                          word-break:break-all;" class="mode-td" > <%= t('payment_mode') %></td>
                      <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;width:25%;
                          min-width:25%;
                          max-width:25%;
                          word-break:break-all;" class="note-td" > <%= t('payment_notes') %></td>
                      <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;width:20%;
                          min-width:20%;
                          max-width:20%;
                          word-break:break-all;" class="amount-td" > <%= t('amount') %>  (<%= currency %>  )</td>
                  </tr>
                  <% @paid_fees.each_with_index do|p,indx| %>

                    <tr style="border: 1px solid #ADACAB;" class="<%= cycle(c,(["odd","even"]-[c]).first) %> <%= "paid" if @paid_fees.last.id.to_i == p.id.to_i and @financefee.is_paid == false%>">
                        <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff; width:10%;
                            min-width:10%;
                            max-width:10%;
                            word-break:break-all;" class="sl-td" ><%= i+=1 %></td>
                        <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;width:14%;
                            min-width:14%;
                            max-width:14%;
                            word-break:break-all;" class="date-td" ><%= p.transaction_date.to_s %></td>
                        <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;width:16%;
                            min-width:16%;
                            max-width:16%;
                            word-break:break-all;" class="rec-td"> <%= p.receipt_no %></td>
                        <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;width:15%;
                            min-width:15%;
                            max-width:15%;
                            word-break:break-all;" class="mode-td" > <%= p.payment_mode %></td>
                        <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;width:25%;
                            min-width:25%;
                            max-width:25%;
                            word-break:break-all;" class="note-td" > <%= p.payment_note %></td>
                        <td style="padding: 12px 15px 12px 12px;border: 1px solid #ADACAB;border-left: 0px solid #fff;border-top: 0px solid #fff;width:20%;
                            min-width:20%;
                            max-width:20%;
                            word-break:break-all;" class="amount-td" ><%= precision_label p.amount.to_f %></td>
                    </tr>
                  <% end %>

                <% end %>
            </table>

        </div>


    </div>
</div>


