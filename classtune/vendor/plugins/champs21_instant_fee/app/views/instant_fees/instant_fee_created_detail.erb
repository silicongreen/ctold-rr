<%-# Champs21
#Copyright 2010 teamCreative Private Limited
#
#This product includes software developed at
#Project Champs21 - http://www.champs21.com/
#
#Licensed under the Apache License, Version 2.0 (the "License");
#you may not use this file except in compliance with the License.
#You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
#Unless required by applicable law or agreed to in writing,
#software distributed under the License is distributed on an
#"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
#KIND, either express or implied.  See the License for the
#specific language governing permissions and limitations
#under the License. -%>

<div id="content-header">
<%= show_header_icon %>
  <h1><%= t('instant_fees_text') %></h1>
<div class='header-sep'>|</div>
<div class='sub-header'><%= "#{t('view_created_instant_fee')}" %></div>
<div id="inner-tab-menu">
  <ul>
    <li id="particular"><%= link_to "#{t('new_text')}", :controller => 'instant_fees',:action => 'new_instant_fees' %></li>
  </ul>
</div>
</div>
<div id="page-yield">
  <div id="flash_box">
  </div>
  <% unless flash[:notice].nil? %>
    <p class="flash-msg"> <%= flash[:notice] %> </p>
  <% end %>

  <div id="list_transactions">
    <div class="extender"></div>
    <div style="padding-bottom: 20px;">
        <div style=""><label style="font-size: 16px;"><%= t('payee_name') %></label><span class="colon">:</span><div class="detail_describe themed_text"><%= @instant_fee.payee_name %></div></div><br />
        <div style="padding-top:10px;"><label style="font-size: 16px;"><%= t('category_name') %></label><span class="colon">:</span><div class="detail_describe themed_text"><%= @instant_fee.category_name %></div></div>
      <% if @instant_fee.finance_transaction.present? %>
        <% unless @instant_fee.finance_transaction.receipt_no.nil? or @instant_fee.finance_transaction.receipt_no.empty? %>
        <div style="padding-top:10px;"><label style="font-size: 16px;"><%= t('receipt_no') %></label><span class="colon">:</span><div class="detail_describe themed_text"><%= @instant_fee.finance_transaction.receipt_no %></div></div>
        <% end %>
      <% end %>
    </div>
    <div style="clear: both; height: 20px;"></div>
    <% total_amount = 0 %>
    <% total_quantity = 0 %>
    <% total_net_amount = 0 %>
    <table class="table table-striped table-bordered" id="example" cellspacing="0" cellpadding="0" border="0" style="width: 98%;">
      <thead><!-- class="thead-inverse" -->
        <tr>
          <th class="col-sl"><%= t('sl_no') %></th>
          <th class="col-2"><%= t('particular_name') %></th>
          <th class="col-2"><%= t('amount') %></th>
          <th class="col-2"><%= t('quantity') %></th>
          <th class="col-2"><%= t('discount') %>(%)</th>
          <th class="col-total"><%= t('total_amount') %></th>
        </tr>
      </thead>
      <tbody>
      <% @instant_fee_details.each_with_index do |detail,index| %>
        <tr class="tr-<%= cycle('odd','even') %>">
          <td class="col-sl"><%= index +=1 %></td>
          <td class="col-2"><%= detail.particular_name %></td>
          <td class="col-2" style="text-align: right;">
            <%= precision_label(detail.amount) %>
          </td>
          <td class="col-2" style="text-align: center;">
            <% if detail.quantity.to_i == 0 %>  
              <span style="font-weight: bold; display: block; text-align: center;">  &minus;</span>
            <% else %>
            <%= detail.quantity %>
            <% end %>
          </td>
          <td class="col-2" style="text-align: right;">
            <%= precision_label(detail.discount) %>
          </td>
          <td class="col-total" style="text-align: right;">
            <%= precision_label(detail.net_amount) %>
          </td>
          <% total_amount += detail.amount  unless detail.amount.nil?%>
          <% total_quantity += detail.quantity  unless detail.quantity.nil?%>
          <% total_net_amount += detail.net_amount unless detail.net_amount.nil?%>
        </tr>
      <% end %>
      <tr class="tr-<%= cycle('odd','even') %>">
        <td class="total themed_text" colspan ="2" style="text-align: right"><span style="font-weight: bold; display: block; text-align: right;"><%= t('total') %></span></td>
        <td class="col-2" style="text-align: right;">
            <span style="font-weight: bold; display: block; text-align: right;"><%= precision_label(total_amount) %></span>
        </td>
        <td class="col-2" style="text-align: right;">
            &nbsp;
        </td>
        <td class="col-2"></td>
        <td class="col-total" style="text-align: right;">
            <span style="font-weight: bold; display: block; text-align: right;"><%= precision_label(total_net_amount) %></span>
        </td>
      </tr>
      <tr>
        <td colspan="6" style="text-align: center; padding: 20px;">
          <%= link_to "#{t('print_receipt')}", {:controller=> "instant_fees",:action => "print_reciept" ,:id=>@instant_fee.id}, :target => "_blank", :class=>"print_receipt", :style=>" "%>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>
