
  <div id="box">
    <% unless flash[:notice].nil? %>
      <p class="flash-msg"> <%= flash[:notice] %> </p>
    <% end %>
    <div id="form-errors"></div>
    <%remote_form_for :exam_group, :url=>{:action=>'update_exam_group', :id=>@exam_group.id} do |form| %>

      <div class="label-field-pair">
        <label><%= t('name') %></label>
        <div class="text-input-bg"><%= form.text_field :name %></div>
      </div>
      <div class="label-field-pair">
        <label><%= t('start_date') %></label>
        <div class="text-input-bg"><%= calendar_date_select_tag "exam_group[start_date]",I18n.l(@exam_group.start_date),:readonly=>true,:popup=>:force%></div>
      </div>
    
      <div class="label-field-pair">
        <label for="name"> Start Time </label>
        <div class="time-select-field"><%= time_select :exam_group, :start_time, {:minute_step => 5} %></div>
      </div>

    
      <div class="label-field-pair">
        <label><%= t('end_date') %></label>
        <div class="text-input-bg"><%= calendar_date_select_tag "exam_group[end_date]",I18n.l(@exam_group.end_date),:readonly=>true,:popup=>:force%></div>
      </div>
      <div class="label-field-pair">
        <label for="name">End Time  </label>
        <div class="time-select-field"><%= time_select :exam_group, :end_time, {:minute_step => 5} %></div>
      </div>
      <div class="label-field-pair">
        <label><%= t('maximum_time_minutes') %></label>
        <div class="text-input-bg"><%= form.text_field :maximum_time %></div>
      </div>
      <div class="label-field-pair">
        <label><%= t('pass_percentage') %></label>
        <div class="text-input-bg"><%= form.text_field :pass_percentage %></div>
      </div>

      <div class="label-field-pair" style="display: none;">
        <label><%= t('shift_label') %></label>
        <div class="text-input-bg">
          <%= select :student, :batch_name, options_for_select(@batches.map {|b| [b.name, b.id]}, @batch_no.to_i),
            {:prompt => "#{t('select')}"},
            {:onChange => "#{remote_function(:url => {:controller => "student", :action => "get_classes"}, :with => "'batch_id='+value+'&'+$('new_student').serialize()+'&page=course_assingment&partial_view=student/courses_assingment&section_page=section_assingment&section_partial=student/sections_assignment_view'" ,:before => "$('loading_2').show();",
            :success => "$('loading_2').hide();")}"} %>
          <%= image_tag("loader.gif", :align => "absmiddle", :border => 0, :id => "loading_2", :style =>"display: none;" ) %>
        </div>
      </div>

      <div class="label-field-pair" style="display: none;">
        <label><%= t('class_label') %></label>
        <div class="text-input-bg">
          <div id="course_assingment">
            <%= render :partial => 'student/courses_assingment', :object => @courses %>
          </div>
        </div>
      </div>

      <div style="display: none;">
        <div class="label-field-pair" id="sections_div">
          <label><%= t('section_label') %></label>
          <div class="text-input-bg">
            <div id="section_assingment">
              <%= render :partial => 'student/sections_assignment_view', :object => @classes %>
            </div>
          </div>
        </div>
      </div>
    
      <div id="syllabus" class="news_label_field">
        <div class="label-field-pair" style="margin: 0px auto;">
          <label for="assignment_subject"><%= "#{t('subject')}"%></label>
          <div class="text-input-bg">
            <% unless @subjects.nil? %>
              <%= select :assignment, :subject,
                #"#{s.name}  - #{s.batch.full_name}"
              @subjects.map {|s| [s.name,s.id]},
                {:prompt => "#{t('select_a_subject')}", :selected => @exam_group.subject_id.nil? ? '' : @exam_group.subject_id} %>
            <% end %>
          </div>
          <%= image_tag("loader.gif",:align => "absmiddle",:border => 0,:id => "loader", :style =>"display: none;" ) %>
        </div>  
      </div>
    
      <div class="label-field-pair">
          <label for="title">Is Common?</label>
          <div class="text-input-bg">
              <%= form.select :is_common,options_for_select([['Yes',1],['No',0]],@exam_group.is_common) %>
          </div>
      </div>
    
            <% @students = Student.find_all_by_batch_id(@exam_group.batch_id) %>
            <% unless @exam_group.students.blank?  %>
              <% @assigned_students = @exam_group.students.split(",") %>
            <% end %>
            <% unless @students.nil? %>
              <div class="scrollable" <% if @exam_group.is_common.to_i == 1 %> style="display:none;" <% end %>>
                  <% unless @students.empty? %>
                    <% @assigned_students ||= [] %>

                    <div class="select_all">
                        <%  if check_free_school? %>
                          <a href='javascrip:void(0)' class='themed_text subscribed-messege' >All</a>,
                          <a href='javascrip:void(0)' class='themed_text subscribed-messege' >None</a>,
                        <% else %>  
                          <%= "#{t('select')}:"%> <%= link_to_function "#{t('all')}", "$$('input.right').each(function(checkbox) { checkbox.checked = true; });" ,:class=>"themed_text"%>,
                          <%= link_to_function "#{t('none')}", "$$('input.right').each(function(checkbox) { checkbox.checked = false; });" ,:class=>"themed_text" %>
                        <% end %>  
                    </div>
                    <div id="scrollable-list">

                        <% @students.each do |s| %>
                          <div class="listitem">
                              <div class="student_name"> <%= s.full_name %> </div>
                              <div class="check_box"> 
                                 <%= check_box_tag "assignment[student_ids][]", s.id,@assigned_students.include?(s.id.to_s),:class=>"right" %>
                              </div>
                          </div>
                        <% end %>
                    </div>
                  <% else %>
                    <p class="flash-msg"><%= t('no_students') %></p>
                  <% end %>
              </div>
            <% end  %>

      <div id="submit-button">
        <%=form.submit("â–º #{t('update')}") %>
      </div>
    <% end %>
  </div>
<script>
  var $jq = jQuery.noConflict(true);
  $jq(document).on("change", "#exam_group_is_common", function () {
      var val = $jq(this).val();
      if (val == 0)
      {
          $jq(".scrollable").show();
      } else
      {
          $jq(".scrollable").hide();
      }

  });

</script> 
<style>
    
  #box form {
      height: 500px;
      overflow-y: auto;
  }
  #MB_frame .label-field-pair .time-select-field select
  {
          width: 87px !important;
  }
  .label-field-pair input, .label-field-pair select
  {
      margin: 5px 0 0 0 !important;
  }
   #MB_frame .label-field-pair .time-select-field
   
   {
       float:left;
       clear:both;
       margin-top:5px;
   }
   .calendar_date_select
   {
       position: fixed !important;
   }
   
    .scrollable {
        width: 413px;
        background-color: #EEE;
        padding: 7px;
        float: left;
        clear: both;
        margin: 20px 0px;
        -webkit-border-radius: 5px;
        -moz-border-radius: 10px;
    }
    #scrollable-list {
        width: 413px;
        overflow: auto;
        height: 160px;
    }
    .select_all{
        font-weight: bold;
        font-size: 14px;
        margin-bottom:10px;
    }
    .select_all a {
        color: #9F0C14;
        text-decoration: none;
    }
    .select_all a:hover {
        color: #9F0C14;
        text-decoration: none;
    }
    .listitem{
        margin-bottom: 2px;
        border-bottom: 1px solid #DDDDDD;
        overflow: hidden;
        font-size:14px;
    }
    .listitem .check_box {
        float:left;
        width: 5px;
    }
    .listitem .student_name {
        float: left;
        width: 375px;
    }
</style>
