<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" media="screen" rel="stylesheet" type="text/css" />
<script type="text/javascript"> function setOption(optn) {document.getElementById("option").value = optn;} </script>

<div id="content-header">
<%= show_header_icon %>
  <h1><%= t('user_details') %></h1>
<div class='header-sep'>|</div>
<div class='sub-header'><%= t('view_details') %></div>

<div id="inner-tab-menu">
  <ul>
    <li class='themed_bg themed-dark-hover-background'><%= link_to "#{t('transport_details')}", :controller => "transport", :action => "transport_details" %></li>
  </ul>
</div>

</div>
<div id="page-yield">
  <% unless flash[:notice].nil? %> <p class="flash-msg"> <%= flash[:notice] %> </p> <% end %>
  <div style="width: 800px;">
    <form name="search_form" action="" style="display:inline;">
      <%= hidden_field_tag("option", params['option'], :value => "student") %>
      <div class="label-field-pair" style="width: 99%;">  
        <div class="label-container" style="text-align: right; padding-top: 10px; font-weight: bold; font-size: 16px;">
          <%= t('search_text') %>: 
          <%= image_tag("loader.gif",
            :align => "absmiddle",
            :border => 0,
            :id => "loader",
            :style =>"display: none;" ) %>
        </div>
        <div class="input-container">
          <%= text_field_tag("query", params['query'], :autocomplete => 'off') %><br/>
        </div>
      </div>
      
      <div class="radio_button" style="display: block; margin-left: 31%;">
          <input type="radio" name="setopt" id="search_present_students_radio" checked="checked" onclick="setOption('student')" /><%= t('student_text') %>
          <input type="radio" name="setopt" id ="search_former_students_radio"onclick="setOption('employee')" /><%= t('employee_text') %>
      </div>  
     
    </form>
  </div>
  <div class="extender"></div>
  <div id="information" style="width: 100%;"></div>
</div>


<div id="view_all">

</div>

<style>
    .transport_chkbox {
        display: none;
    }
</style>


<%#= observe_fields ['query', 'option'],
:frequency => 0.5,
:update => 'information',
:before => "Element.show('loader')",
:success => "Element.hide('loader')",
:url => {:action => 'search_ajax'} %>

<script type="text/javascript">
  function search_ajax(){
    if ($('query').value.include("%")) return;
<%="#{remote_function(:url => {:action => "search_ajax"},
:with => "j('form').serialize()",
:before => "Element.show('loader')",
:success => "Element.hide('loader')",
:update=>"information"
)}"%>
  }

  document.observe("dom:loaded", function() {
    new Form.Element.Observer('query', 1, search_ajax);
    new Form.Element.Observer('option', 0.5, search_ajax);
  });

</script>


<script>
  j(document).ready(function(){
      j(document).on('click', '.transport_chk', function(){
          var count_fees = 0;
          var id = this.id;
          
          if ( j(this).hasClass('fa-check-square-o') )
          {
              j(this).addClass('fa-square-o');
              j(this).removeClass('fa-check-square-o');
          }
          else
          {
              j(this).removeClass('fa-square-o');
              j(this).addClass('fa-check-square-o');
          }
          
          j(".transport_chkbox").each(function(){
            var val = this.value;
            if ( val == id )
            {
                if ( j("#" + id).hasClass('fa-check-square-o') )
                {
                  j(this).prop("checked", true);
                }
                else
                {
                  j(this).prop("checked", false);
                }
            }
          });
      });
      
      j(document).on('click', '.transport_chk_all', function(){
          if ( j(this).hasClass('fa-check-square-o') )
          {
              j(this).addClass('fa-square-o');
              j(this).removeClass('fa-check-square-o');
              
              j(".transport_chk").each(function(){
                  j(this).addClass('fa-square-o');
                  j(this).removeClass('fa-check-square-o');
              });
          }
          else
          {
              j(this).removeClass('fa-square-o');
              j(this).addClass('fa-check-square-o');
              
              j(".transport_chk").each(function(){
                  j(this).removeClass('fa-square-o');
                  j(this).addClass('fa-check-square-o');
              });
          }
          
          j(".transport_chkbox").each(function(){
            var val = this.value;
            var obj = this;
            j(".transport_chk").each(function(){
              var id = this.id;
              if ( val == id )
              {
                  if ( j("#" + id).hasClass('fa-check-square-o') )
                  {
                    j(obj).prop("checked", true);
                  }
                  else
                  {
                    j(obj).prop("checked", false);
                  }
              }
            });
          });
      });
  });
</script>