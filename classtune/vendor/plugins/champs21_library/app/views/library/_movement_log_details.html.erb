<% unless @log.blank? %>
  <div class="info">
    <div class="field_pair">
      <div class="label1"><%= "#{t('total')} #{t('book_text')}" %></div>
      <div class="label2"><%=": #{@log.total_entries}" %></div>
    </div>
  </div>
  <div class="submit-button">
    <%= link_to "#{t('export_as_csv')}" ,{:action=>'movement_log_csv',:sort_order=>@sort_order,:book_log=>params[:book_log]} %>
  </div>
  <div class="extender"></div>
  <div id="page-yield" class="ch_book_wrapper">
    <div class="extender"></div>
    <table id="report_table" align="center" width="100%" cellpadding="1" cellspacing="1">
      <tr class="tr-head sub-heading">
        <td><%= t('no_text') %></td>

       

        <% if @sort_order=="first_name DESC" %>
          <td class="batch_order_select">
            <%= link_to_remote  "#{t('borrowed_by')} &#8595;", :url=>{:action=>"movement_log",:sort_order=>"first_name ASC",:book_log=>params[:book_log]} %>
          </td>
        <% elsif @sort_order=="first_name ASC" %>
          <td class="batch_order_select">
            <%= link_to_remote  "#{t('borrowed_by')} &#8593;", :url=>{:action=>"movement_log",:sort_order=>"first_name DESC",:book_log=>params[:book_log]} %>
          </td>
        <% else %>
          <td class="batch_order">
            <%= link_to_remote  "#{t('borrowed_by')}", :url=>{:action=>"movement_log",:sort_order=>"first_name DESC",:book_log=>params[:book_log]} %>
          </td>
        <% end %>
        <td>
            User Type
        </td>
        <td>
            Number Of Books
        </td>
        
      </tr>
      <%j=0 %>
      <% @log.each_with_index do |r,@i| %>
        <% if params[:page].present? %>
          <% if params[:page].to_i >= 1 %>
            <% @i = @i  + (params[:page].to_i - 1) * @log.per_page.to_i %>
          <% end %> <%else %> <% @i = @i %>
        <% end %>
        <% j+=1 %>
        <tr class="tr-<%= cycle('odd', 'even') %>">
          <td class="col-5"> <%=@i+1 %></td>
          
          <% if @sort_order=="first_name ASC" or @sort_order=="first_name DESC" %>
            <% if r.student? %>
              <td class="col-2 batch_order_select"><%=link_to "#{r.first_name} #{r.last_name} - #{r.admission_no} (Student)" ,{:controller=>'student',:action=>'profile' ,:id=>r.student_id}%></td>
            <% else %>
              <td class="col-2 batch_order_select"><%=link_to "#{r.first_name} #{r.last_name} - #{r.employee_number} (Employee)" ,{:controller=>'employee',:action=>'profile' ,:id=>r.employee_id}%></td>
            <% end %>
          <% else %>
            <% if r.student? %>
              <td class="col-2"><%=link_to "#{r.first_name} #{r.last_name} - #{r.admission_no}" ,{:controller=>'student',:action=>'profile' ,:id=>r.student_id}%></td>
            <% else %>
              <td class="col-2"><%=link_to "#{r.first_name} #{r.last_name} - #{r.employee_number}" ,{:controller=>'employee',:action=>'profile' ,:id=>r.employee_id}%></td>
            <% end %>
          <% end %>
          <% if r.student? %>
              <td class="col-2">Student</td>
            <% else %>
              <td class="col-2">Employee</td>
            <% end %>
          <td class="col-2">
                <%= link_to  "#{r.number_of_book}",{:action=>"movement_log_details",:user_id=>r.user_id_log},:target=>"_blank" %>
          </td>
         
        </tr>
      <% end %>
    </table>
    <% unless @log.per_page.to_i > @log.total_entries.to_i %>
      <div class="pagination_list">
        <div class="pagination_text">
          <%= "#{t('showing')} #{@i+1-(j-1)}-#{@i+1} #{t('of')} #{@log.total_entries}" %>
        </div>
        <%= will_paginate @log,:renderer => 'RemoteLinkRenderer' ,:page_links=>false ,:params=>{:sort_order=>@sort_order,:book_log=>params[:book_log]}%>
      </div>
    <% end %>
  <% else %>
    <p class="flash-msg"> <%= t('no_record_found') %></p>
  <% end %>
</div>
