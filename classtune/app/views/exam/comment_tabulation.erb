<%-# Champs21
#Copyright 2010 teamCreative Private Limited
#
#This product includes software developed at
#Project Champs21 - http://www.champs21.com/
#
#Licensed under the Apache License, Version 2.0 (the "License");
#you may not use this file except in compliance with the License.
#You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
#Unless required by applicable law or agreed to in writing,
#software distributed under the License is distributed on an
#"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
#KIND, either express or implied.  See the License for the
#specific language governing permissions and limitations
#under the License. -%>
<link rel="stylesheet" href="/stylesheets/jquery.auto-complete.css">
<%= javascript_include_tag 'jquery.auto-complete.js' %>
 <div class="header-wrapper">
    <% unless @current_user.student? or @current_user.parent? %>
          <div id="inner-tab-menu">
            <ul style="margin: 10px 20px 0 0;">
              
              <li class="themed_bg themed-dark-hover-background"><%= link_to "Pdf Download",
                        {:action => "comment_tabulation_pdf",:id=>@connect_exam_obj.id},:target => '_blank' %></li>
            </ul>
          </div>
      <% end %>
 </div>  
<div id="page-yield" style="margin:10px 0">

  <div class="box">
    
    <% if MultiSchool.current_school.id == 2 or MultiSchool.current_school.id == 312 %>
      <%= render  :partial=>"/connect_exam/south_point/comment_tabulation" %>  
    <% elsif MultiSchool.current_school.id == 340 %>
      <%= render  :partial=>"/connect_exam/comment_tabulation" %>
    <% else %>
      <%= render  :partial=>"/connect_exam/sir_john_wilson_school/comment_tabulation" %>
    <% end %>
  </div>
<%= image_tag("loader.gif",:align => "absmiddle",:border => 0,:id => "loader2", :style =>"display: none;" ) %><div id="success-messege" style ="display: none; margin-bottom:10px; color: green;">Successfully Saved...</div><input type="button" value="Save Comments" name="exam_comment_save_all" id="exam_comment_save_all" />
</div>

<script>
  var comments_connect_exam = "";
  var std_ids_connect_exam = "";
  var jj = jQuery.noConflict();
  jj(document).ready(function () {
      jj('#exam_comment_save_all').click(function () {
          Element.show('loader2');
          Element.hide('success-messege');
          comments_connect_exam = ""
          std_ids_connect_exam = ""
          jj( ".comment_input_box_connect_exam" ).each(function( index ) {
            var value = jj(this).val();
            if(value)
            {
                var comment_input_id_string = jj(this).attr("id");
                var comment_input_id_array = comment_input_id_string.split("_");
                var comment_input_id = comment_input_id_array[1];
                comments_connect_exam = comments_connect_exam+encodeURIComponent(value)+"||";
                std_ids_connect_exam = std_ids_connect_exam+comment_input_id+"||"
                
            }  
          });
          if(comments_connect_exam)
          {
              new Ajax.Request('/exam/add_comments_connect_exam',
                      {asynchronous: true, evalScripts: true,
                          parameters: 'comments=' + comments_connect_exam+"&student_ids="+std_ids_connect_exam+"&connect_exam=<%= @connect_exam_obj.id %>", onSuccess: function (request) {
                              Element.hide('loader2');
                              Element.show('success-messege');
                          }
                      });
          }  
          else
          {
             Element.hide('loader2');
          }
      });
  });
</script>

<% if (MultiSchool.current_school.id == 312 or MultiSchool.current_school.id == 2) and (!params[:blank_page].blank? and params[:blank_page].to_i==1)  %>
<style>
 .school_feed_box
{
    width:0px;
    display:none;
}
.champs21_palette_container_1 #boxes
{
    
    display:none;
    height: 0px;
}
#header_bg
{
    display:none;
    height: 0px;
}
#content-header
{
    display:none;
    height: 0px;
}
#content_wrapper
{
    margin-top:-100px !important;
    width:auto;
    padding:0px;
    
}
.zui-scroller {
   
    width: auto;
    overflow-x: hidden;
    overflow-y: hidden;
    max-height: none;
}
#footer
{
    display:none;
}
#content
{
    padding-bottom: 0px !important;
    width: 100% !important;
}
.header-wrapper
{
   display:none;
}
#page-yield
{
    margin:0px 0px;
}
</style>    
<% end %>
