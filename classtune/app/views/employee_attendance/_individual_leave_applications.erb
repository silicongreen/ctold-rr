<%-# Champs21
#Copyright 2010 teamCreative Private Limited
#
#This product includes software developed at
#Project Champs21 - http://www.champs21.com/
#
#Licensed under the Apache License, Version 2.0 (the "License");
#you may not use this file except in compliance with the License.
#You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
#Unless required by applicable law or agreed to in writing,
#software distributed under the License is distributed on an
#"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
#KIND, either express or implied.  See the License for the
#specific language governing permissions and limitations
#under the License. -%>

<div class="wrapper">
  <% unless @applied_leaves.nil? %>

    <% @applied_leaves.each do |l| %>
      <a href="/employee_attendance/own_leave_application/<%= l.id %>">
        <div class="my_leave_row">
          <div class="my_leave_info_wrapper">
            <div class="student_info">
              <span class="student_name"><%= @employee.full_name %>, </span>
              <span class="student_addition_info"><%= @employee.employee_category.name %> <%= @employee.employee_position.name %>, <%= @employee.employee_department.name %></span>
            </div>
            <div class="leave_info">Apply Date: <%= I18n.l(l.created_at.to_date, :format=>'%d/%m/%Y') %></div>
            <div class="leave_info">Duration:
              <%= I18n.l(l.start_date.to_date, :format=>'%d/%m/%Y') %> to <%= I18n.l(l.end_date.to_date, :format=>'%d/%m/%Y') %>
            </div>
          </div>
          <div class="my_leave_status_wrapper">
            <% unless l.viewed_by_manager %>
              <% str_class = 'pending' %>
            <% else %>
              <% if l.approved? %>
                <% str_class = 'approved' %>
              <% else %>
                <% str_class = 'declined' %>
              <% end %>
            <% end %>

            <div class="<%= str_class %>">
              <%= image_tag "/images/icons/leave/#{str_class}.png", :class => str_class %>
            </div>
          </div>
        </div>
      </a>
    <% end %>

    <% posted_params = params %>
    <% posted_params.delete(:page) %>
    <% posted_params.delete(:authenticity_token) %>
    <% posted_params.delete(:controller) %>
    <% posted_params.delete(:action) %>
    <%  @url_params = "" %>
    <% posted_params.each{|k,v| @url_params = @url_params.to_s+k.to_s+"="+v.to_s+"&"}  %>
    <%= will_paginate @applied_leaves,:renderer => 'RemoteLinkRenderer',:remote=>{:update=>'application-list'} %>
  <% else %>
    <div class="no-data-available"><%= t('no_leave_application') %></div>
  <% end %>

</div>