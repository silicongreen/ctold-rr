<div id="palettes-main">
<%# reminder_count = @current_user.reminder_count %>
    <%
      if @current_user.parent?
      profile_id = @current_user.guardian_entry.current_ward_id 
      else
      profile_id = @current_user.student_record.id 
      end
    @conn = ActiveRecord::Base.connection

     
  %>
    <div class="champs21_palette_container_1">
        <div id='boxes' style="float:left;margin-right: 0px;width:69%;">
            <div id="demo2" class="als-container" data-id="als-container_0">
                <div class="good-read-box-scroll">
                    <div class="als-viewport"  style="float:left;  overflow: hidden; width: auto;">
                    <ul class="als-wrapper"   data-id="als-wrapper_0" style="width: 635px;  height: 135px;"> 
                    
                            
                            <li class="als-item">
                                <% 
                                 
                                sql = "SELECT COUNT( reminders.id ) AS total_count
FROM reminders
LEFT JOIN assignments  ON reminders.rid = assignments.id
WHERE reminders.recipient = #{@current_user.id}
AND reminders.is_read = 0
AND reminders.rtype = 4
AND assignments.assignment_type = 1
AND assignments.duedate >= NOW()
AND FIND_IN_SET(#{profile_id},student_list)"

                                homework_count_data = @conn.execute(sql).all_hashes

                              %>

                                <%  
                                hcount = "";
                                unless homework_count_data[0]['total_count'].nil? || homework_count_data[0]['total_count'].to_i==0
                                  hcount = "<span class='f2 reminder-count'>"+homework_count_data[0]['total_count'].to_s+"</span>"
                                end
                              %>
                                <%= link_to_remote "<div class='homework_box_icon active'>"+hcount+"<span class='f2'>HOMEWORK</span></div>",
                                  :update => "dashboard-data",
                                  :before => "Element.show('loader');j('.partial_homework').empty();",
                                  :success => "Element.hide('loader');j('#boxes div').removeClass('active');j('#boxes .homework_box_icon').addClass('active');",
                                  :url => {:controller=>"dashboards",:action => "homework_data"} %>
                            </li>
                         
                            
                            <li class="als-item">
                                <%          
                                sql = "SELECT COUNT( reminders.id ) AS total_count
FROM reminders
LEFT JOIN online_exam_groups  ON reminders.rid = online_exam_groups.id
WHERE reminders.recipient = #{@current_user.id}
AND reminders.is_read = 0
AND reminders.rtype = 15
AND online_exam_groups.is_deleted = 0
AND online_exam_groups.is_published = 1"

                                quize_count_data = @conn.execute(sql).all_hashes

                              %> 
                                <% 
                                hcount = ""
                                unless quize_count_data[0]['total_count'].nil? || quize_count_data[0]['total_count'].to_i==0
                                  hcount = "<span class='f2 reminder-count'>"+quize_count_data[0]['total_count'].to_s+"</span>"
                                  end
                              %>
                                <%= link_to_remote "<div class='quiz_box_icon'>"+hcount+"<span class='f2'>QUIZ</span></div>",
                                  :update => "dashboard-data",
                                  :before => "Element.show('loader');j('.partial_homework').empty();",
                                  :success => "Element.hide('loader');j('#boxes div').removeClass('active');j('#boxes .quiz_box_icon').addClass('active');",
                                  :url => {:controller=>"dashboards",:action => "quize_data"} %>
                            </li>
                           
                            
                            
                            <li class="als-item">
                                <%= link_to_remote "<div class='rountine_box_icon'><span class='f2'>CLASS ROUTINE</span></div>",
                                  :update => "dashboard-data",
                                  :before => "Element.show('loader');j('.partial_homework').empty();",
                                  :success => "Element.hide('loader');j('#boxes div').removeClass('active');j('#boxes .rountine_box_icon').addClass('active');",
                                  :url => {:controller=>"dashboards",:action => "class_routine_data_student"} %>
                            </li>
                       
                            
                            
                          
                            <li class="als-item">
                                <%          
                                sql = "SELECT COUNT( reminders.id ) AS total_count
FROM reminders
INNER JOIN exam_groups  ON reminders.rid = exam_groups.id
WHERE reminders.recipient = #{@current_user.id}
AND reminders.is_read = 0
AND reminders.rtype = 2
AND exam_groups.is_published = 1"

                                exam_count_data = @conn.execute(sql).all_hashes

                              %> 
                                <% 
                                hcount = ""
                                unless exam_count_data[0]['total_count'].nil? || exam_count_data[0]['total_count'].to_i==0
                                  hcount = "<span class='f2 reminder-count'>"+exam_count_data[0]['total_count'].to_s+"</span>"
                                  end
                              %>
                                <%= link_to_remote "<div class='exam_box_icon'>"+hcount+"<span class='f2'>EXAM ROUTINE</span></div>",
                                  :update => "dashboard-data",
                                  :before => "Element.show('loader');j('.partial_homework').empty();",
                                  :success => "Element.hide('loader');j('#boxes div').removeClass('active');j('#boxes .exam_box_icon').addClass('active');",
                                  :url => {:controller=>"dashboards",:action => "exam_routine_data_student"} %>
                            </li>
                            
                      
                            <li class="als-item">
                                <% 
                                sql = "SELECT COUNT( reminders.id ) AS total_count
FROM reminders
INNER JOIN exam_groups  ON reminders.rid = exam_groups.id
WHERE reminders.recipient = #{@current_user.id}
AND reminders.is_read = 0
AND reminders.rtype = 3
AND exam_groups.is_published = 1
AND exam_groups.result_published = 1"

                                exam_count_data = @conn.execute(sql).all_hashes

                              %> 
                                <% 
                                hcount = ""
                                unless exam_count_data[0]['total_count'].nil? || exam_count_data[0]['total_count'].to_i==0
                                  hcount = "<span class='f2 reminder-count'>"+exam_count_data[0]['total_count'].to_s+"</span>"
                                  end
                              %>
                                <%= link_to_remote "<div class='report_box_icon'>"+hcount+"<span class='f2'>REPORT CARD</span></div>",
                                  :update => "dashboard-data",
                                  :before => "Element.show('loader');j('.partial_homework').empty();",
                                  :success => "Element.hide('loader');j('#boxes div').removeClass('active');j('#boxes .report_box_icon').addClass('active');",
                                  :url => {:controller=>"dashboards",:action => "exam_result_data_student"} %>
                            </li>
                           
                            
                           
                            <li class="als-item">
                                <%=  link_to "<div class='syllabus_box_icon'><span class='f2'>SYLLABUS</span></div>", :controller => 'syllabus', :action => 'syllabus_view' %>
                            </li>
                            
                            
                          
                            <li class="als-item">
                                <%=  link_to "<div class='lessonplan_box_icon'><span class='f2'>LESSON PLAN</span></div>", :controller => 'lessonplan', :action => 'index' %>                
                            </li>
                        
                           
                            <li class="als-item">
                                <%=  link_to "<div class='calendar_box_icon'><span class='f2'>CALENDAR</span></div>", :controller => 'calendar', :action => 'index' %>                
                            </li>
                         
                            
                            <% if @current_user.student? %>
                              <% 
                              student_id = @current_user.student_entry.id
                            %>
                            
                            <% end %>

                            <% if @current_user.parent? %>
                              <% 
                              student_id = @current_user.guardian_entry.current_ward_id                 
                            %>
                             
                              <li class="als-item">
                                  <%=  link_to "<div class='fees_box_icon'><span class='f2'>FEES</span></div>", :controller => 'student', :action => 'fees', :id => student_id %>                
                              </li>
                            
                              
                             
                              <li class="als-item">
                                  <%=  link_to "<div class='leave_box_icon'><span class='f2'>LEAVE</span></div>", :controller => 'student_attendance', :action => 'leaves', :id => student_id %>
                              </li>
                              
                              
                              
                              <li class="als-item" >
                                  <%=  link_to "<div class='meeting_box_icon'><span class='f2'>MEETING</span></div>", :controller => 'meetings', :action => 'index' %>                             
                              </li>
                          
                              
                            <% end %>
                            
                          
                            <li class="als-item" >
                                <%=  link_to "<div class='transport_box_icon'><span class='f2'>Transport</span></div>", :controller => 'transport', :action => 'student_transport_details', :id => student_id %>                             
                            </li>
                         
                        </ul>
                        
                    </div>
                   
                    <span style="height: 149px; float:left; clear:none; position: static; margin-left:10px;" class="als-next" data-id="als-next_0"></span>
              
                </div>
            </div>
            
            <div style="clear:both;"></div>
            <div class="loader-image" id="partial_page_loader">
                <%= image_tag("loader2.gif",
                  :align => "absmiddle",
                  :border => 0,
                  :id => "loader",
                  :style =>"display: none;" ) %>
            </div>
            <div class="box_content" id="dashboard-data">
                <%=   render :partial => "homework", :locals=>{:homework=>homework, :hw_data => false} %>
            </div>      
        </div>

        <div class="school_feed_box">
            <%= render :partial => "attendance" %>
            <div style="clear:both;height: 20px;"></div>
            <%= render :partial => "notice", :locals=>{:news=>@news, :type => 'all'} %>
        </div>

    </div>

    <div style="clear:both;"></div>
    <%  if !check_free_school? %>
    <div class="champs21_palette_container_1" style="margin-top: 30px;">

        <% unless @event.nil? %>
          <div class="school_feed_box" style="margin-right: 34px;">
              <%= render :partial => "event", :locals=>{:event=>@event} %>
          </div>
        <% end %>

        <div class="school_feed_box" style="margin-right: 34px;">
            <%=  link_to "<img src='/images/dashpallete/big_icon/sylabus.png' style='width:100%'>", :controller => 'syllabus', :action => 'syllabus_view' %><br/><br/>
            <%=  link_to "<img src='/images/dashpallete/big_icon/lesson_plan.png' style='width:100%'>", :controller => 'lessonplan', :action => 'index' %><br/><br/>
            <%=  link_to "<img src='/images/dashpallete/big_icon/calender.png' style='width:100%'>", :controller => 'calendar', :action => 'index' %>
        </div>

        <div class="school_feed_box" style="height: 300px;">
            <% if !@allow_detention.blank? %>
            <%=  link_to "<img src='/images/dashpallete/big_icon/displine.png' style='width:100%'>", :controller => 'detention', :action => 'index' %>
            <% end %>
            <% if @current_user.parent? %>
              <% 
              student_id = @current_user.guardian_entry.current_ward_id                 
            %>
              <%=  link_to "<img src='/images/dashpallete/big_icon/fees.png' style='width:100%'>", :controller => 'student', :action => 'fees', :id => student_id %><br/><br/>
              <%=  link_to "<img src='/images/dashpallete/big_icon/Leave.png' style='width:100%'>", :controller => 'student_attendance', :action => 'leaves', :id => student_id %><br/><br/>
              <%=  link_to "<img src='/images/dashpallete/big_icon/meeting.png' style='width:100%'>", :controller => 'meetings', :action => 'index' %>         
            <% end %>
        </div>

    </div>
    <% end %>

    <div style="clear:both;"></div>

</div>

<% content_for :head do %>
  <%= javascript_include_tag "custom/jquery.als-1.6.min" %>
<% end %>
<% if @current_user.student? %>
  <%  @student = Student.find(student_id)  %>
<%=@student.is_promoted%>
  <% if @student.is_promoted == 1 %>
  
<div id="overlay-back"></div>
<div id="popup">
<%= link_to_remote "<img src='/images/close.png' class='close-image' />",                                  
                                  :url => {:controller=>"student",:action => "update_is_promoted"}  %>

<img src="/images/dashboard_buttons/promotin.png" />
</div>
<script>
      // you can use just jquery for this
      q(document).ready(function(){
         q('#overlay-back').fadeIn(500,function(){
            q('#popup').show();
         });
 
         q(".close-image").on('click', function() {
            q('#popup').hide();
            q('#overlay-back').fadeOut(500);
         });
      });
</script>
<style type="text/css">
body
{
background-image:url(code.jpg);
-webkit-background-size: cover;
-moz-background-size: cover;
-o-background-size: cover;
background-size: cover;
}
a{
text-decoration:none;
font-size:18px;
color:#333333;
}
a:hover{
text-decoration:underline;
font-size:18px;
color:#333333;
}
#popup{
position:absolute;
display:hidden;
top:160px;
left:50%;
width:500px;
height:auto;
margin-left:-350px;

z-index:6;
padding:20px;

}
#popup h1{
font-family:Verdana, Arial, Helvetica, sans-serif;
font-size:16px;
color:#3F5C9A;
border-bottom:1px #3F5C9A solid;
margin:0;
padding:0;
}
#popup h3{
font-family:Verdana, Arial, Helvetica, sans-serif;
font-size:14px;
color:#666666;
margin:0;
padding:5px 0;
text-align:left;
}
#popup p{
font-family:Verdana, Arial, Helvetica, sans-serif;
font-size:12px;
color:#666666;
margin:0;
padding:5px;
text-align:justify;
}
#popup a{
font-family:Verdana, Arial, Helvetica, sans-serif;
font-size:12px;
color:#666666;
margin:0;
padding:5px;
text-align:right;
float:right;
}
#overlay-back {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: #000;
opacity: 0.6;
filter: alpha(opacity=60);
z-index: 5;
display: none
}
.close-image{
display: block;
float:right;
position:relative;
top:-15px;
right: -15px;
height: 20px;
cursor: pointer;
}
</style>    
    
<% end %>    
<% end %>    
<style type="text/css">    
    #boxes span.reminder-count
    {
        right: 20px;
        top: 30px;
        border: 0px solid black;
        padding: 2px;
        border-radius: 30px;
        background: #CB232A;
        position: absolute;
        color: white;
        height: 20px;
        width: 20px;
    }
    .data-div select {
        float: left;
        width: 260px;
    }
    .data-div input[type="text"] {
        float: left;
    }
    .data-div #loader-circle {
        float: left;
        margin-left: 5px;
        margin-top: 5px;
    }
    .box_content .partial_homework   input
    {
        background: none repeat scroll 0 0 #eeeeee;
        border: 1px solid #c6c6c6;
        height: 18px;
        margin: 0px;
        padding: 2px;
        width: 167px;
    }
    .box_content .partial_homework .text-input-bg select {
        background-color: #eeeeee;
        border: 1px solid #c6c6c6;
        height: 24px;
        padding: 2px 10px;
        margin: 0px;
        width: 175px;
    }
    .box_content .partial_homework .label-div
    {
        margin-top : 2px;
    }
    #filter-div .label-div {
        width:18%;
    }
    #filter-div .calendar_date_select_popup_icon {
        margin: 4px;
    }
    .clear-date {
        color: #db3434;
        cursor: pointer;
        float: right;
        font-size: 12px;
        margin-right: 45px;
        margin-top: 9px;
        width: 0;
    }
</style>


