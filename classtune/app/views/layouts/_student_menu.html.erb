<%
if @current_user.parent?
  profile_id = @current_user.guardian_entry.current_ward_id 
  else
  profile_id = @current_user.student_record.id 
  end
%>
<% 
if @current_user.parent?                 
  student_id = @current_user.guardian_entry.current_ward_id                 
  end
if @current_user.student?                 
  student_id = @current_user.id
  end
@conn = ActiveRecord::Base.connection 
%>

<div class="champs21_palette_container_1">
    <div id='boxes' style="float:left;margin-right: 0px;width:69%;height:120px;">
        <div id="demo2" class="als-container" data-id="als-container_0">
            <div class="good-read-box-scroll">
                <div class="als-viewport" style="float:left; overflow: hidden; width: auto;">
                    <ul class="als-wrapper" data-id="als-wrapper_0" style="width: 635px;  height: 120px;">              
                        
                        <li class="als-item">
                            <% 
                                 
                                sql = "SELECT COUNT( reminders.id ) AS total_count
FROM reminders
LEFT JOIN assignments  ON reminders.rid = assignments.id
WHERE reminders.recipient = #{@current_user.id}
AND reminders.is_read = 0
AND reminders.rtype = 4
AND assignments.assignment_type = 1
AND assignments.duedate >= NOW()
AND FIND_IN_SET(#{profile_id},student_list)"

                                homework_count_data = @conn.execute(sql).all_hashes

                              %>

                            <%  
                            hcount = "";
                            unless homework_count_data[0]['total_count'].nil? || homework_count_data[0]['total_count'].to_i==0
                              hcount = "<span class='f2 reminder-count'>"+homework_count_data[0]['total_count'].to_s+"</span>"
                            end
                          %>
                            <%= link_to "<div class='homework_box_icon'>"+hcount+"<span class='f2'>HOMEWORK</span></div>", :controller => 'assignments', :action => 'index' %>

                        </li>
                      
                      
                        <li class="als-item" >
                           <%          
                                sql = "SELECT COUNT( reminders.id ) AS total_count
FROM reminders
LEFT JOIN online_exam_groups  ON reminders.rid = online_exam_groups.id
WHERE reminders.recipient = #{@current_user.id}
AND reminders.is_read = 0
AND reminders.rtype = 15
AND online_exam_groups.is_deleted = 0
AND online_exam_groups.is_published = 1"

                                quize_count_data = @conn.execute(sql).all_hashes

                            %> 
                            <% 
                            hcount = ""
                            unless quize_count_data[0]['total_count'].nil? || quize_count_data[0]['total_count'].to_i==0
                              hcount = "<span class='f2 reminder-count'>"+quize_count_data[0]['total_count'].to_s+"</span>"
                              end
                          %>
                            <%= link_to "<div class='quiz_box_icon'>"+hcount+"<span class='f2'>QUIZ</span></div>", :controller => 'online_student_exam', :action => 'index' %>

                        </li>
                      
                        
                        <li class="als-item" >
                            <%= link_to "<div class='rountine_box_icon'><span class='f2'>CLASS ROUTINE</span></div>", :controller => 'timetable', :action => 'student_view',:id => profile_id %>                 
                        </li>
                       
                      
                        <li class="als-item">
                            <%          
                            sql = "SELECT COUNT( reminders.id ) AS total_count
FROM reminders
INNER JOIN exam_groups  ON reminders.rid = exam_groups.id
WHERE reminders.recipient = #{@current_user.id}
AND reminders.is_read = 0
AND reminders.rtype = 2
AND exam_groups.is_published = 1"

                            exam_count_data = @conn.execute(sql).all_hashes

                          %> 
                            <% 
                            hcount = ""
                            unless exam_count_data[0]['total_count'].nil? || exam_count_data[0]['total_count'].to_i==0
                              hcount = "<span class='f2 reminder-count'>"+exam_count_data[0]['total_count'].to_s+"</span>"
                              end
                          %>
                            <%= link_to "<div class='exam_box_icon'>"+hcount+"<span class='f2'>EXAM ROUTINE</span></div>", :controller => 'exam', :action => 'student_exam_schedule' %> 

                        </li>
                        
                        <li class="als-item">
                            <% 
                            sql = "SELECT COUNT( reminders.id ) AS total_count
FROM reminders
INNER JOIN exam_groups  ON reminders.rid = exam_groups.id
WHERE reminders.recipient = #{@current_user.id}
AND reminders.is_read = 0
AND reminders.rtype = 3
AND exam_groups.is_published = 1
AND exam_groups.result_published = 1"

                            exam_count_data = @conn.execute(sql).all_hashes

                          %> 
                            <% 
                            hcount = ""
                            unless exam_count_data[0]['total_count'].nil? || exam_count_data[0]['total_count'].to_i==0
                              hcount = "<span class='f2 reminder-count'>"+exam_count_data[0]['total_count'].to_s+"</span>"
                              end
                          %>
                            <%= link_to "<div class='report_box_icon'>"+hcount+"<span class='f2'>REPORT CARD</span></div>", :controller => 'student', :action => 'class_test_report' %> 
                        </li>
                        <% if @current_user.parent? %>
                          <% 
                          student_id = @current_user.guardian_entry.current_ward_id                 
                        %>
                          
                          <li class="als-item" >
                              <%=  link_to "<div class='fees_box_icon'><span class='f2'>FEES</span></div>", :controller => 'student', :action => 'fees', :id => student_id %>                
                          </li>
                        <% end %>
                        <%if Champs21Plugin.can_access_plugin?("champs21_classwork")%>
                        <li class="als-item" >
                          <%=  link_to "<div class='classwork_box_icon'><span class='f2'>CLASSWORK</span></div>", :controller => 'classworks', :action => 'index' %>
                        </li>
                        <% end %>
                        <li class="als-item">
                            <%=  link_to "<div class='syllabus_box_icon'><span class='f2'>SYLLABUS</span></div>", :controller => 'syllabus', :action => 'syllabus_view' %>
                        </li>
                        <li class="als-item">
                            <%=  link_to "<div class='lessonplan_box_icon'><span class='f2'>LESSON PLAN</span></div>", :controller => 'lessonplan', :action => 'index' %>                
                        </li>
                       
                        <li class="als-item">
                            <%=  link_to "<div class='calendar_box_icon'><span class='f2'>CALENDAR</span></div>", :controller => 'calendar', :action => 'index' %>                
                        </li>
                      

                        <% if @current_user.student? %>
                          <% 
                          student_id = @current_user.student_entry.id
                        %>
                        <% end %>

                        <% if @current_user.parent? %>
                          <% 
                          student_id = @current_user.guardian_entry.current_ward_id                 
                        %>
                          
                              <li class="als-item" >
                                  <%=  link_to "<div class='fees_box_icon'><span class='f2'>FEES</span></div>", :controller => 'student', :action => 'fees', :id => student_id %>                
                              </li>
                            
                              
                             
                              <li class="als-item" >
                                  <%=  link_to "<div class='leave_box_icon'><span class='f2'>LEAVE</span></div>", :controller => 'student_attendance', :action => 'leaves', :id => student_id %>
                              </li>
                              
                              
                              
                              <li class="als-item" >
                                  <%=  link_to "<div class='meeting_box_icon'><span class='f2'>MEETING</span></div>", :controller => 'meetings', :action => 'index' %>                             
                              </li>
                         <% end %>
                          
                    
                       
                        <li class="als-item">
                            <%=  link_to "<div class='transport_box_icon'><span class='f2'>Transport</span></div>", :controller => 'transport', :action => 'student_transport_details', :id => student_id %>                             
                        </li>
                     

                    </ul>
                </div>
              
                <span style="height: 149px; float:left; clear:none; position: static; margin-left:10px;" class="als-next" data-id="als-next_0"></span>
             
            </div>
        </div>

        <div style="clear:both;"></div>
    </div>

    <div class="school_feed_box">
        <%= render :partial => "layouts/attendance" %>

    </div>
</div>

<% content_for :head do %>
  <%= javascript_include_tag "custom/jquery.als-1.6.min" %>
<% end %>
<style type="text/css">
    #boxes span.reminder-count
    {
        right: 20px;
        top: 30px;
        border: 0px solid black;
        padding: 2px;
        border-radius: 30px;
        background: #CB232A;
        position: absolute;
        color: white;
        height: 20px;
        width: 20px;
    }
    .data-div select {
        float: left;
        width: 260px;
    }
    .data-div input[type="text"] {
        float: left;
    }
    .data-div #loader-circle {
        float: left;
        margin-left: 5px;
        margin-top: 5px;
    }
    .box_content .partial_homework   input
    {
        background: none repeat scroll 0 0 #eeeeee;
        border: 1px solid #c6c6c6;
        height: 18px;
        margin: 0px;
        padding: 2px;
        width: 167px;
    }
    .box_content .partial_homework .text-input-bg select {
        background-color: #eeeeee;
        border: 1px solid #c6c6c6;
        height: 24px;
        padding: 2px 10px;
        margin: 0px;
        width: 175px;
    }
    .box_content .partial_homework .label-div
    {
        margin-top : 2px;
    }
    #filter-div .label-div {
        width:18%;
    }
    #filter-div .calendar_date_select_popup_icon {
        margin: 4px;
    }
    .clear-date {
        color: #db3434;
        cursor: pointer;
        float: right;
        font-size: 12px;
        margin-right: 45px;
        margin-top: 9px;
        width: 0;
    }
</style>



