<%= render  :partial=>"/connect_exam/mirpur_english/group_report_pdf_type_"+@connect_exam_obj.result_type.to_s %>
<% 
  if @ranked_positions.blank?
    @grouped_exams = GroupedExam.find_all_by_connect_exam_id(@connect_exam_obj.id)
    @exam_group_ids = @grouped_exams.map(&:exam_group_id)
    @ranked_student = ExamScore.all(:select =>["SUM(exam_scores.marks) as total_score,exam_scores.student_id"],:conditions=>["exams.exam_group_id IN (?)",@exam_group_ids],:joins=>[:exam,:student],:group =>"exam_scores.student_id",:order=>"total_score DESC")
    @ranked_positions = {}
    unless @ranked_student.blank?
      p = 0
      @ranked_student.each do |rs|
        p = p+1
        @ranked_positions[rs.student_id.to_i] = p
      end
    end
  end
  
%>