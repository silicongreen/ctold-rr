<%-# Champs21
#Copyright 2010 teamCreative Private Limited
#
#This product includes software developed at
#Project Champs21 - http://www.champs21.com/
#
#Licensed under the Apache License, Version 2.0 (the "License");
#you may not use this file except in compliance with the License.
#You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
#Unless required by applicable law or agreed to in writing,
#software distributed under the License is distributed on an
#"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
#KIND, either express or implied.  See the License for the
#specific language governing permissions and limitations
#under the License. -%>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script>
// Put jQuery 1.10.2 into noConflict mode.
  var $jq1 = jQuery.noConflict(true);
</script>
<div class="header-wrapper">


    <div class="header-title">
        <div class="header-icon">
            <%= image_tag '/images/icons/profile-icon.png', :html => {:alt => 'Student Profile'} %>
        </div>
        <div class="header-title-text-wrapper">
            <div class="header-title-main-text f2">
                <%= t('admission') %>
            </div>
            <div class="clearfix"></div>
            <div class="header-title-sub-text">
                <%= I18n.l(@local_tzone_time.to_date, :format=>'%d/%m/%Y') %>
            </div>
        </div>
    </div>
</div>
<div id="page-yield">
 <% unless flash[:notice].nil? %> <p class="flash-msg"> <%= flash[:notice] %> </p> <% end %>
  <div id="form-content">
    <% form_for :student,:html=>{:onsubmit=>"return sibling_value('#{@student.guardians}');"} do |e| %>
    <script> function update_sibling_selected(id,name)
  {
    $$('.not-selected')[0].innerHTML=name;
    s= new Element('input',{'type':'hidden','value':id,'name':'sibling_no'})
     $('update-button').appendChild(s)
}
function sibling_value(guardians){
  if (guardians.length > 0){
  if (confirm('<%= "#{t('it_will_delete_all_the_current_guardians_of')}#{@student.full_name}"%>')) {


 
 if ($$('.not-selected')[0].innerHTML=="(<%= t('not_selected') %>)")
 {
   alert('<%= "#{t('please_select_a_sibling_and_proceed')}"%>');
   return false;
 }
 else
 {
   return true
 }
}else{return false}
}else{
  if ($$('.not-selected')[0].innerHTML=="(<%= t('not_selected') %>)")
 {
   alert('<%= "#{t('please_select_a_sibling_and_proceed')}"%>');
   return false;
 }
 else
 {
   return true
 }

}}
</script>
    <div id="admission1_form">
      <div class="f1-steps">
          <div class="f1-progress">
              <div class="f1-progress-line" data-now-value="40.5" data-number-of-steps="3" style="width: 40.5%;"></div>
          </div>
          <div class="f1-step">
              <div class="f1-step-icon"><div class="fa">1</div></div>
              <p>Student Information</p>
          </div>
          <div class="f1-step active">
              <div class="f1-step-icon"><div class="fa">2</div></div>
              <p>Select Siblings</p>
          </div>
          <div class="f1-step">
              <div class="f1-step-icon"><div class="fa">3</div></div>
              <p>Previous Details</p>
          </div>
          <div class="f1-step">
              <div class="f1-step-icon"><div class="fa">4</div></div>
              <p>Aditional Information</p>
          </div>
      </div>
    </div>    
    <%=hidden_field_tag :configure,params[:configure]%>
    <div class="sibling">
          <div id="sibling-selected"><%= t('sibling_selected') %>:</div>
          <div id="sibling-selected-name" class="themed_text"><span class="not-selected">(<%= t('not_selected') %>)</span></div>
          <div id="update-button">
            <%=submit_tag  ("► #{t('save_and_proceed')}"),  :class => "btn btn-success"%>
            <%if params[:configure].present?%>
            <%=link_to ("► #{t('cancel')}"),{:action=>"guardians",:id=>params[:id]},:class => "btn btn-success"%></div>
            <%else%>
            <%=link_to ("► #{t('skip')}"),{:action=>"admission2",:id=>params[:id]},:class => "btn btn-success"%></div>
          <%end%>
    </div>
          <div class="extender"></div>
        
     <%end%>

  <div id="search_box_bg">
    <form id="sibling-form" name="search_form" action="" style="display:inline;">
      <%= hidden_field_tag("option", params['option'], :value => "active") %>
      <label for="user_name"><%= t('search_text') %>:
        <%= image_tag("loader.gif",
          :align => "absmiddle",
          :border => 0,
          :id => "loader",
          :style =>"display: none;" ) %>
      </label> 
      <div id="search_textbox">
        <%= text_field_tag("query", params['query'], :autocomplete => 'off') %>

      </div>

      <div class="extender"></div>
       
    </form>
  </div>
 

  <div id="view_all">

  </div>


  <script type="text/javascript">
    function search_ajax(){
      if ($('query').value.include("%")) return;
<%="#{remote_function(:url => {:action => "search_ajax"},
:with => "'query='+$('query').value + '&option='+'sibling'",
:before => "Element.show('loader')",
:success => "Element.hide('loader')",
:update=>"information"
)}"%>
  }

  document.observe("dom:loaded", function() {
    new Form.Element.Observer('query', 1, search_ajax);
    new Form.Element.Observer('option', 0.5, search_ajax);
  });

  </script>

  </div>


  <div id="information"></div>

</div>
<%= stylesheet_link_tag 'tadded-header' %>
<%= stylesheet_link_tag 'form-bootstrap' %>
<% content_for :head do %>
  <%= javascript_include_tag "custom/tabbed-header" %>
<% end %>  
