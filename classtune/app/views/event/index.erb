<%-# Champs21
#Copyright 2010 teamCreative Private Limited
#
#This product includes software developed at
#Project Champs21 - http://www.champs21.com/
#
#Licensed under the Apache License, Version 2.0 (the "License");
#you may not use this file except in compliance with the License.
#You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
#Unless required by applicable law or agreed to in writing,
#software distributed under the License is distributed on an
#"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
#KIND, either express or implied.  See the License for the
#specific language governing permissions and limitations
#under the License. -%>

<div class="header-wrapper">
  <div class="header-title">
    <div class="header-icon">
      <%= image_tag '/images/icons/event.png', :html => {:alt => 'New Event'} %>
    </div>
    <div class="header-title-text-wrapper">
      <div class="header-title-main-text f2">
        Event
      </div>
    </div>
  </div>

  <div class="clearfix"></div>

  <div class="tabbed-header-wrapper">
    <ul class="header-tabs">
      <li class="active">
        <%= link_to "New Event", {:controller=>"event"}, {:class => 'f2'} %>
      </li>
      <li>
        <%= link_to "Event List", {:controller=>"calendar", :action=>"list_events"}, {:class => 'f2'} %>
      </li>
    </ul>
  </div>
</div>

<div id="page-yield">
  <%= flash[:notice] %>
  <% form_for :events, :html => { :multipart => true } do |f| %>
    <%= error_messages_for 'events' %>

    <div class="label-field-pair">
      <label for="start-date"><%= t('start_date') %>:</label>
      <div class="text-input-bg"><%= calendar_date_select_tag 'events[start_date]', I18n.localize(@start_date || @date, :format=>("%Y-%m-%d %H:%M")), :time => true , :readonly=>true, :popup=>"force" %></div>
    </div>

    <div class="label-field-pair">
      <label for="end-date"><%= t('end_date') %>:</label>
      <div class="text-input-bg"><%= calendar_date_select_tag 'events[end_date]', I18n.localize(@end_date || @date, :format=>("%Y-%m-%d %H:%M")), :time => true , :readonly=>true, :popup=>"force" %></div>
    </div>

    <div class="label-field-pair">
      <label for="event_category"><%= t('category') %></label>
      <div class="text-input-bg"><%= f.select :event_category_id, @event_categories.map {|c| [c.name, c.id]} %></div>
    </div>

    <div class="label-field-pair">
      <label for="title"><%= t('title') %>:</label>
      <div class="text-input-bg"><%= f.text_field :title %></div>
    </div>

    <div class="label-field-pair">
      <label for="title"><%= "Pointing Color" %>:</label>
      <div class="text-input-bg"><input type="text" id="text-field" name="events[pointing_color]" class="demo" value="#FFCF27"></div>
    </div>

    <div class="label-field-pair" style="float:left; clear:both; display:none;">
      <label >Upload Image (<%= t('max_size') %>)</label>
      <div class="text-input-bg" id="event-image"><%= f.file_field :event_image %></div>
    </div>

    <div class="label-field-pair">
      <label for="description"><%= t('description') %>:</label>
    </div>

    <%= f.text_area "description" %>
    <div class="label-field-pair">
      <label for="is-holiday"><%= t('is_holiday') %>?</label>
      <%= f.check_box :is_holiday %>
    </div>

    <div class="label-field-pair">
      <label for="end-date"><%= t('common_event') %></label>
      <%= f.check_box :is_common %>
    </div>
    <%= hidden_field :events,"is_published", :value =>1 %>

    <%= f.submit "► #{t('create_event')}", :disable_with => "► #{t('please_wait')}" %>
    
    <input style="margin: 0px 0px 0px 10px;
    padding:10px;
    color: #fff;
    background: #db3434;
    font-weight: bold;
    font-size: 14px;
    border: none;
    cursor: pointer;background:#49BB4B !important; height:auto;" name="commit" 
    onclick="j('#events_is_published').val('0');if (window.hiddenCommit) { window.hiddenCommit.setAttribute('value', this.value); }else { hiddenCommit = document.createElement('input');hiddenCommit.type = 'hidden';hiddenCommit.value = this.value;hiddenCommit.name = this.name;this.form.appendChild(hiddenCommit); }this.setAttribute('originalValue', this.value);this.disabled = true;this.value='► Please Wait';result = (this.form.onsubmit ? (this.form.onsubmit() ? this.form.submit() : false) : this.form.submit());if (result == false) { this.value = this.getAttribute('originalValue');this.disabled = false; }return result;" 
    type="submit" value="► Save As Draft">

  <% end %>
  <%= load_redactor_script %>
</div>

<script>
  j(document).ready( function() {

    j(".demo").minicolors();

  });
</script>

<%= stylesheet_link_tag 'tadded-header' %>
<%= stylesheet_link_tag 'bootstrap_form' %>
<%= stylesheet_link_tag 'event/jquery.minicolors' %>
<% content_for :head do %>
  <%= javascript_include_tag "minicolorpicker/jquery.minicolors" %>
<% end %>