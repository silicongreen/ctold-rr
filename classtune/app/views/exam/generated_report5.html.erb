<%-# Champs21
#Copyright 2010 teamCreative Private Limited
#
#This product includes software developed at
#Project Champs21 - http://www.champs21.com/
#
#Licensed under the Apache License, Version 2.0 (the "License");
#you may not use this file except in compliance with the License.
#You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
#Unless required by applicable law or agreed to in writing,
#software distributed under the License is distributed on an
#"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
#KIND, either express or implied.  See the License for the
#specific language governing permissions and limitations
#under the License. -%>

<div class="header-wrapper">
    <div class="header-title" style="width:68%;">
      <div class="header-icon"  style="width:12%;">
        <%= image_tag '/images/icons/report-card.png', :html => {:alt => 'Report'} %>
      </div>
      <div class="header-title-text-wrapper">
        <div class="header-title-main-text f2">
          <%= @connect_exam_obj.name  %> Report
        </div>
        <div class="header-title-sub-text">
          <%= Time.now.strftime("%B, %Y") %>
        </div>
      </div>
    </div>
   </div>
  
<div id="page-yield" style="margin:10px 0">
       
  <% unless @current_user.student? or @current_user.parent? %>
          <div class="bread_crumb" style="margin-bottom:10px;">
            <%= link_to t('exam_text'), :controller => "exam", :action=>"index" %> <div class = "bread-crumb-separator"> > </div>
            <%= link_to t('report_center'), :controller => "exam", :action => "report_center" %> <div class = "bread-crumb-separator"> > </div>
            <%= link_to t('grouped_exam_reports'), :controller => "exam", :action => "grouped_exam_report_new" %> <div class = "bread-crumb-separator"> > </div>
            <%= t('generated_report') %>
          </div>
  <% end %>
  <% unless flash[:notice].nil? %>
    <p class="flash-msg"> <%= flash[:notice] %> </p>
  <% end %>
  <h4 align="center"><%= @batch.name %> - <%= @batch.course.full_name %></h4>
  <% unless @previous_batch == 1 %>
  <div id="student_list">
    <%= render  :partial=>"student_list_new" %>
  </div>
  <% end %>
  <% unless @previous_batch == 1 %>
  <div class ="current_batch" style="margin-top:-10px;">
  <div id="grouped_exam_report">
    <%= render :partial=>'grouped_exam_report_new' %>
  </div>
  </div>
  <% else %>
  <div class ="previous_batch">
  <div id="grouped_exam_report">
    <%= render :partial=>'grouped_exam_report_new' %>
  </div>
  </div>
  <% end %>
<%#*<div class="box">%>
<%#*</div>%>

</div>
<% content_for :head do %>
  <%= javascript_include_tag "swfobject" %>
  <%= javascript_include_tag "custom/tabbed-header" %>
<% end %>

<%= stylesheet_link_tag 'tadded-header' %>
<%= stylesheet_link_tag 'inline-calendar' %>
<script type="text/javascript">
  function set_active(){
    $$('.active-link').each(function(e){
      e.removeClassName('active-link');
    });
    this.addClassName('active-link')
  }
  function draw_report(){
    Element.show('loader')
    new Ajax.Request('/exam/generated_report5',
    {asynchronous:true, evalScripts:true,
      parameters:'student='+this.id+'&type=<%= @type %>&connect_exam=<%= @connect_exam %>',onSuccess:function(request){Element.hide('loader')}
    })
  }
  document.observe("dom:loaded", function() {
    $$('.student-link-new').invoke('observe','click',draw_report);
    $$('.student-link-new').invoke('observe','click',set_active);
  });
</script>
