<?php/** * @class Login * @Defination Use for login logout ajaxvalid user check etc * @author Fahim */if (!defined('BASEPATH'))    exit('No direct script access allowed');class login extends MX_Controller{    public function __construct()    {        parent::__construct();        $this->form_validation->CI = & $this;    }    /**     * Index function     * @param None     * @post username,password,captcha     * @defination use for login admin user     * @author Fahim     */    public function index()    {        $this->load->helper('captcha');                $obj_user = new User();        $obj_settings = new Settings();                $obj_user->username = $this->input->post('username');        $obj_user->password = $this->input->post('password');        $captcha = $this->input->post('captcha');        $obj_settings_data = $obj_settings->get_value("key", "enabled_admin_captcha");        // Attempt to log user in with the data they supplied, using the login function setup in the User model        // You might want to have a quick look at that login function up the top of this page to see how it authenticates the user        if ($obj_user->login($captcha, $obj_settings_data->value))        {            $remeber = TRUE;                        $obj_user->group->get();            $sessionData['admin']['username'] = $obj_user->username;            $sessionData['admin']['name'] = $obj_user->name;            $sessionData['admin']['id'] = $obj_user->id;            $sessionData['admin']['group_id'] = $obj_user->group->id;                        if($remeber)            {               $this->session->sess_expiration = (60*60*24*365*2);            }                          $this->session->set_userdata($sessionData);            redirect("admin/manage");        }        else        {            if ( $obj_settings_data->value )            {                $vals = array(                    'img_path' => './captcha/',                    'img_url' => base_url() . 'captcha/',                    'img_width' => 150,                    'img_height' => 30,                    'expiration' => 60                );                $cap = create_captcha($vals);                $data = array(                    'captcha_time' => $cap['time'],                    'ip_address' => $this->input->ip_address(),                    'word' => $cap['word']                );                $query = $this->db->insert_string('captcha', $data);                $this->db->query($query);                $data['captcha'] = $cap['image'];                $data['has_captcha'] = TRUE;            }            else            {                $data['has_captcha'] = FALSE;            }                        $data['model'] = $obj_user;            $this->render('admin/login', $data);        }    }    /**     * @function Logout     * @defination Admin logout function     * @author Fahim     */    function logout()    {        $array_items = array('admin' => array());        $this->session->unset_userdata($array_items);        $this->session->sess_destroy();        redirect("admin/login");    }}