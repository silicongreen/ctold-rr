<div class="box">
      <% batch_names = [] %>
       <% @batches.each do |batch| %>
          <% unless batch_names.include?(batch.name) %>
            <% batch_names << batch.name %>
          <% end %>
      <% end %>
      
      <% if batch_names.count > 1 %>
      <select name="batch_id" id="batch_id" />
        <option value="" />Select Shift</option>
        <% batch_names.each do |batch| %>
            
            <option value="<%= batch.gsub(" ", "_") %>" /><%= batch %></option>
          
        <% end %>
      </select>
      <% end %>
      <% if batch_names.count == 1 %>
        <% class_names = [] %>
         <% @batches.each do |batch| %>
            <% unless class_names.include?(batch.course.course_name) %>
              <% class_names << batch.course.course_name %>
            <% end %>
        <% end %>
        <select name="class_id" class="class_id" id="<%= batch_names[0].gsub(" ", "_") %>_class" />
        <option value="" />Select Class</option>
          <% class_names.each do |class_name| %>
              
              <option value="<%= batch_names[0].gsub(" ", "_") %>_<%= class_name.gsub(" ", "_") %>" /><%= class_name %></option>
          <% end %>
        </select>
        <% class_names.each do |class_name| %>
          <% section_names = [] %>
            <% @batches.each do |batch| %>
               <% if batch.course.course_name == class_name %>
                 <% section_names << batch.course.section_name %>
               <% end %>
           <% end %>
          <select name="section_id"  class="section_id" style="display:none;" id="<%= batch_names[0].gsub(" ", "_") %>_<%= class_name.gsub(" ", "_") %>_section" />
            <option value="" />Select Section</option>
            <% section_names.each do |section| %>
                
                <option value="<%= batch_names[0] %> <%= class_name %> <%= section %>" /><%= section %></option>
            <% end %>
          </select>
      
        <% end %>
        
      <% else %>
       
        <% batch_names.each do |batch_name| %>
          <% class_names = [] %>
            <% @batches.each do |batch| %>
               <% unless class_names.include?(batch.course.course_name) %>
                 <% if batch_name == batch.name %>
                  <% class_names << batch.course.course_name %>
                 <% end %>
               <% end %>
           <% end %>
          <select name="class_id"  class="class_id" style="display:none;" class="" id="<%= batch_name.gsub(" ", "_") %>_class" />
            <option value="" />Select Class</option>
            <% class_names.each do |class_name| %>
                
                <option value="<%= batch_name.gsub(" ", "_") %>_<%= class_name.gsub(" ", "_") %>" /><%= class_name %></option>
            <% end %>
          </select>
      
          <% class_names.each do |class_name| %>
          <% section_names = [] %>
            <% @batches.each do |batch| %>
               <% if batch.course.course_name == class_name %>
                 <% section_names << batch.course.section_name %>
               <% end %>
           <% end %>
          <select name="section_id"  class="section_id" style="display:none;" id="<%= batch_name.gsub(" ", "_") %>_<%= class_name.gsub(" ", "_") %>_section" />
            <option value="" />Select Section</option>
            <% section_names.each do |section| %>
                
                <option value="<%= batch_name %> <%= class_name %> <%= section %>" /><%= section %></option>
            <% end %>
          </select>
      
        <% end %>
      
        <% end %>
      
      
      <% end %>
      
  </div>

<script>
  var jj = jQuery.noConflict();
  jj(document).ready(function () {
    batch_id_current = "";
    jj("#batch_id").change(function(){
      if(jj("#batch_id").val())
      {
        batch_id_current = jj("#batch_id").val();
        oDataTable.column( 1 ).search("").column( 0 ).search( jj("#batch_id").val().replace(/\_/g, ' '),false,false).draw();
        jj(".class_id").val("");
        jj(".class_id").hide();
        jj(".section_id").val("");
        jj(".section_id").hide();
        jj("#"+jj("#batch_id").val()+"_class").show();
      }
      else
      {
        batch_id_current = "";
        oDataTable.column( 1 ).search("").column( 0 ).search("").draw();
        jj(".class_id").val("");
        jj(".class_id").hide();
        jj(".section_id").val("");
        jj(".section_id").hide();
        //oDataTable.column( 0 ).search("").val(),false,false).draw();
      }   
    });
    
    
    class_id_current = "";
    jj(".class_id").change(function(){
      if(jj(this).val())
      {
        class_id_current = jj(this).val();
        oDataTable.column( 1 ).search("").column( 0 ).search( jj(this).val().replace(/\_/g, ' '),false,false).draw();
        jj(".section_id").val("");
        jj(".section_id").hide();
        
        jj("#"+jj(this).val()+"_section").show();
      }
      else
      {
        class_id_current = batch_id_current
        oDataTable.column( 1 ).search("").column( 0 ).search(batch_id_current.replace(/\_/g, ' '),false,false).draw(); 
        jj(".section_id").val("");
        jj(".section_id").hide();
      }   
    });
    
    
  
  });
</script>