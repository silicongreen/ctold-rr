(function(a){var b={defaults:{ajaxUrl:"",display:{successMessage:false},scroll:{onError:true,onErrorOffset:100,onSuccess:true,onSuccessOffset:100},fields:{}},settings:{},setOpts:function(c){this.settings=a.extend({},this.defaults,c)},rules:{},setRules:function(){for(var c=0;c<this.settings.fields.length;c++){if("rating"===this.settings.fields[c].type){if(1===this.settings.fields[c].required){this.rules[this.settings.fields[c].name]={ratingRequired:true}}}}},init:function(){var c={};if(typeof window.strongForm!=="undefined"){c=window.strongForm}this.setOpts(c);if(this.settings.display.successMessage){this.scrollOnSuccess()}else{this.setRules();this.changeEvents();this.customValidators();this.validateForm()}},changeEvents:function(){a("input[type=url]").change(function(){if(this.value.length&&!/^https*:\/\//.test(this.value)){this.value="http://"+this.value}});var d=document.getElementsByClassName("strong-rating");for(var c=0;c<d.length;c++){d[c].addEventListener("click",this.handleRadioEvent,true);d[c].addEventListener("keyup",this.handleRadioEvent,true);d[c].addEventListener("change",function(){a(this).valid()},true)}},handleRadioEvent:function(d){if(d.keyCode>=48&&d.keyCode<=53){var c=d.keyCode-48;a(this).find("input[type='radio'][value="+c+"]").click()}},customValidators:function(){a.validator.addMethod("ratingRequired",function(d,c){return a(c).find("input:checked").val()>0},a.validator.messages.required)},validateForm:function(){a("#wpmtst-submission-form").validate({onfocusout:false,focusInvalid:false,invalidHandler:function(f,e){var h=e.numberOfInvalids();if(h){if(b.settings.scroll.onError){if(typeof e.errorList[0]!=="undefined"){var d=a(e.errorList[0].element);var c=d.closest(".form-field").offset();var g=c.top-b.settings.scroll.onErrorOffset;a("html, body").animate({scrollTop:g},800,function(){d.focus()})}}else{e.errorList[0].element.focus()}}},submitHandler:function(d){if(b.settings.ajaxUrl!==""){var c={url:b.settings.ajaxUrl,data:{action:"wpmtst_form2"},success:b.showResponse};a(d).ajaxSubmit(c)}else{d.submit()}},rules:b.rules,errorPlacement:function(c,d){c.appendTo(d.closest("div.form-field"))},highlight:function(e,c,d){if(e.type==="checkbox"){a(e).closest(".field-wrap").addClass(c).removeClass(d)}else{if("rating"===a(e).data("fieldType")){a(e).closest(".field-wrap").addClass(c).removeClass(d)}else{a(e).addClass(c).removeClass(d)}}},unhighlight:function(e,c,d){if(e.type==="checkbox"){a(e).closest(".field-wrap").removeClass(c).addClass(d)}else{if("rating"===a(e).data("fieldType")){a(e).closest(".field-wrap").removeClass(c).addClass(d)}else{a(e).removeClass(c).addClass(d)}}}})},showResponse:function(c){var e=JSON.parse(c);if(e.success){a("#wpmtst-form").html(e.message);b.scrollOnSuccess()}else{for(var d in e.errors){if(e.errors.hasOwnProperty(d)){a("div.wpmtst-"+d).find("span.error").remove().end().append('<span class="error">'+e.errors[d]+"</span>")}}}},scrollOnSuccess:function(){if(b.settings.scroll.onSuccess){var c,d;c=a(".testimonial-success").offset();if(c){d=c.top-b.settings.scroll.onSuccessOffset;if(a("#wpadminbar").length){d-=32}a("html, body").animate({scrollTop:d},800)}}}};b.init();a('input[type="text"], input[type="url"], input[type="email"], textarea',"#wpmtst-submission-form").on("change blur",function(c){c.target.value=c.target.value.trim()})})(jQuery);