<%-# Champs21
#Copyright 2010 teamCreative Private Limited
#
#This product includes software developed at
#Project Champs21 - http://www.champs21.com/
#
#Licensed under the Apache License, Version 2.0 (the "License");
#you may not use this file except in compliance with the License.
#You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
#Unless required by applicable law or agreed to in writing,
#software distributed under the License is distributed on an
#"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
#KIND, either express or implied.  See the License for the
#specific language governing permissions and limitations
#under the License. -%>

<!--<div id="content-header">
<%#= show_header_icon %>
  <h1><%#= t('school_news') %></h1>
<div class='header-sep'>|</div>
<div class='sub-header'><%#= t('latest_announcement') %></div>

<div id="inner-tab-menu">
  <ul>
    <li class='themed_bg themed-dark-hover-background'><%#= link_to "#{t('view_all')}", :controller => 'news', :action => 'all' %></li>
    <%# if permitted_to? :add,:news %>
      <li class='themed_bg themed-dark-hover-background'><%#= link_to "#{t('add')}", :controller => 'news', :action => 'add' %></li>
    <%# end %>
  </ul>
</div>
</div>-->

<div class="header-wrapper">
  <div class="header-title">
    <div class="header-icon">
      <%= image_tag '/images/icons/notice.png', :html => {:alt => 'Notice'} %>
    </div>
    <div class="header-title-text-wrapper">
      <div class="header-title-main-text f2">
       <a href="/news/all">Notice</a>
      </div>
      <div class="header-title-sub-text f5">

        </div>
      </div>
    </div>    

  <div class="header-form-wrapper">
      <div class='header-right-button'><%= link_to "#{t('view_all')}", :controller => 'news', :action => 'all' %></div>
        <% if permitted_to? :add,:news %>
          <div class='header-right-button'><%= link_to "#{t('add')}", :controller => 'news', :action => 'add' %></div>
        <% end %>
  </div>
</div>

<div id="page-yield" style="margin-top: 0px;">
  <div id="search_add_news_area">
    <% unless flash[:notice].nil? %><p class="flash-msg"> <%= flash[:notice] %> </p><% end %>
    <div class="news_search_add">
      <div id="news_bg">
        <form name="s1form" action="" style="display:inline;">
          <h2><%= t('search_text') + ' ' + t('news_text') %></h2>
          <%= text_field_tag("query", params['query'], :autocomplete => 'off') %>
          <div id="go"><%= submit_tag "", :value =>"#{t('search_text')}", :controller=> 'news', :action=>"index" %></div>
        </form>
        <div class="extender2"></div>
      </div>
    </div>
    <div class="extender"></div>
  </div>





  <% unless @news.empty? %>
    <div id="all_news">
      <table id="listing" align="center" width="100%" cellpadding="1" cellspacing="1">
        <tr class="tr-head">
          <td>
            <%= t('sl_no') %>
          </td>
          <td>
            <%= t('title') %>
          </td>
          <td>
            <%= t('author') %>
          </td>
          <td>
            <%= t('comments') %>
          </td>
          <td>
            <%= t('posted') %>
          </td>
        </tr>
        <tr class="tr-blank"></tr>
        <% @news.each_with_index do |r,i| %>
          <% @comments = NewsComment.find_all_by_news_id(r.id) %>
          <% link_value = r.title %>
          <tr class="tr-<%= cycle('odd', 'even') %>">
            <td class="col-1">
              <%= i+1 %>
            </td>
            <td class="col-4">
              <%=  link_to link_value, :controller => 'news', :action => 'view', :id => r.id%>
            </td>
            <td class="col-4">
              <% unless r.author.blank?  %>
                <%= r.author.first_name %> <%= '- admin' if r.author.admin==true%>
              <% else %>
                <%= t('user_deleted') %>
              <% end %>
            </td>
            <td class="col-1">
              <%= @comments.size %>
            </td>
            <td class="col-3">
              <%= time_ago_in_words(r.created_at) %> <%= t('ago') %>
            </td>
          </tr>
        <% end %>

      </table>
    </div>
  <% else %>
    <% unless params[:query].nil? %>
      <p class="flash-msg"> <%= "#{t('sorry_your_search')} ' #{params[:query]} ' #{t('did_not_fetch_any_result')}" %></p>
    <% end %>
  <% end %>

  <div class="extender"></div>
</div>
<%= stylesheet_link_tag 'tadded-header' %>