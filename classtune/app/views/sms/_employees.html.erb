<%-# Champs21
#Copyright 2010 teamCreative Private Limited
#
#This product includes software developed at
#Project Champs21 - http://www.champs21.com/
#
#Licensed under the Apache License, Version 2.0 (the "License");
#you may not use this file except in compliance with the License.
#You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
#Unless required by applicable law or agreed to in writing,
#software distributed under the License is distributed on an
#"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
#KIND, either express or implied.  See the License for the
#specific language governing permissions and limitations
#under the License. -%>

<iframe name="receiver" id="receiver" style="display: none;"></iframe>
<div style="float: left;">
  <div id="content-header">
    <%= show_header_icon %>
    <h1><%= t('sms_text') %></h1>
    <div class='header-sep'>|</div>
    <div class='sub-header'><%= t('employees') %></div>
  </div>
    
  <div id="page-yield-new">
    <div class="box">
      <% form_for :send_sms, :html => {:target=>'receiver', :onsubmit => "return checkdata();", :id => "sms_form", :before=>"$('submit_button').disable();$('loader1').show();",:complete=>"setTimeout(function(){$('submit_button').enable();$('loader1').hide();},5000)"} do |x| %>
        <input type="hidden" name="option_sms" id="option_sms" value="employee" />
        <div style="clear: both; height: 12px;"></div> 
        <div class="label-field-pair">
          <div class="label-container"><label>Select Option</label></div>
          <div class="text-input-bg">
            <select name="send_sms[is_test]" id="is_test">
              <option value="1">Test</option>
              <option value="0">Live</option>
            </select>
          </div>
          <div style="clear: both; height: 12px;"></div> 
        
          <div id="batch_panel" style="display: none;">
            <div class="label-container"><label><%= t('select_a_department') %>:</label> </div>
            <div class="text-input-bg text-input-bg2" style="height: 320px;">
              <%= select :send_sms, :batch_id,
                EmployeeDepartment.all.map {|b| [b.name, b.id]},
                {:prompt => "#{t('select_a_department')}"},
                {:multiple => true,:onChange => "#{remote_function(:url => {:action => "list_employees_new"},
                :with => "'dept_id='+j('#send_sms_batch_id').val()",
                :before => "Element.show('loader')",
                :success => "Element.hide('loader')"
                )}"} %>
              <%= image_tag("loader.gif",
                :align => "absmiddle",
                :border => 0,
                :id => "loader",
                :style =>"display: none;" ) %>
            </div>
          </div>
          <div class="label-container"><label>Only Download?</label></div>
          <div class="text-input-bg">
            <select id="sms_options_type" name="send_sms[download]">
              <option value="1">Yes</option>
              <option value="0">No</option>
            </select>
          </div>
        </div>

        <div style="clear: both; height: 12px;"></div> 
        <div id="employee-list">
            <%= render :partial => "test_employee" %> 
        </div>

      <% end %>

      <div id="status-message">

      </div>
      <%= image_tag("loader2.gif",
        :align => "absmiddle",
        :border => 0,
        :id => "loader2",
        :style =>"display: none;" ) %>

    </div>
  </div>
</div>
<style>
.text-input-bg2 select
{
   height: 300px;
}
p.flash-msg
{
  float:left;
  clear: both;
}
</style> 
