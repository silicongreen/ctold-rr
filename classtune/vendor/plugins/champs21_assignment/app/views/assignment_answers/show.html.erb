<div class="box_content" style="background: #ffffff; float:left;">
<div class="partial_homework" style="padding: 20px;">

  <a href="/assignments"><h2 class="f2 routine">HOMEWORK | <%= @assignment.subject.name.to_s %></h2></a>


<div id="page-yield" class="ch_homework_answers_wrapper">
<% unless flash[:notice].nil? %> <p class="flash-msg"> <%= flash[:notice] %> </p> <% end %>
<div id="answer-container">
  <h4><%= "#{t('assignment_text')}"%></h4>
  <% if @assignment_answer.assignment.present? %>
    <div class="assignment-question"><%= link_to @assignment_answer.assignment.title.to_s , @assignment %></div>
  <% else %><div class="assignment-question"><%= t('this_answer_is_not_for_the_assignment') %></div>

  <% end %>
  <h4><%= "#{t('answer')}"%></h4>
  <div class="assignment-answer">
    <div class="assignment-answer-title"><%= @assignment_answer.title.to_s   %></div>
    <div class="assignment-answer-content"><%= @assignment_answer.content.to_s %></div>
    <% unless @assignment_answer.attachment_file_name.nil? %> <div id="attachment"><%= link_to @assignment_answer.attachment_file_name.to_s, :controller => "assignment_answers", :action => "download_attachment" , :assignment_answer=>@assignment_answer.id %></div><%  end %>
    
    <% unless @assignment_answer.attachment2_file_name.nil? %> <div id="attachment"><%= link_to @assignment_answer.attachment2_file_name.to_s, :controller => "assignment_answers", :action => "download_attachment" , :assignment_answer=>@assignment_answer.id, :number=>2 %></div><%  end %>
    
    <% unless @assignment_answer.attachment3_file_name.nil? %> <div id="attachment"><%= link_to @assignment_answer.attachment3_file_name.to_s, :controller => "assignment_answers", :action => "download_attachment" , :assignment_answer=>@assignment_answer.id, :number=>3 %></div><%  end %>
  </div>
  <% unless @assignment_answer.attachment_file_name.nil? %>
      <%
        file_type = "none"
        if !@assignment_answer.attachment_file_name.upcase.index(".PNG").blank? or !@assignment_answer.attachment_file_name.upcase.index(".JPG").blank? or !@assignment_answer.attachment_file_name.upcase.index(".JPEG").blank? or !@assignment_answer.attachment_file_name.upcase.index(".GIF").blank?
          file_type = "image"
        end
        if !@assignment_answer.attachment_file_name.upcase.index(".PDF").blank?
          file_type = "pdf"
        end
        if !@assignment_answer.attachment_file_name.upcase.index(".DOCX").blank? or !@assignment_answer.attachment_file_name.upcase.index(".DOC").blank? or !@assignment_answer.attachment_file_name.upcase.index(".XLS").blank? or !@assignment_answer.attachment_file_name.upcase.index(".XLSX").blank? or !@assignment_answer.attachment_file_name.upcase.index(".CSV").blank?
          file_type = "doc"
        end
        
    
      %>
      <% if file_type == "doc" %>
        <iframe width="100%" height="500px" src="https://docs.google.com/viewer?url=https://<%= MultiSchool.current_school.code %>.classtune.com<%= @assignment_answer.attachment.url %>&embedded=true&print=true" style="border:0px;"   frameborder="0" ></iframe>
      <% end %>
      <% if file_type == "image" %>
        <img src="https://<%= MultiSchool.current_school.code %>.classtune.com<%= @assignment_answer.attachment.url %>" style=" max-width: 100%;" />
      <% end %> 
      <% if file_type == "pdf" %>
        <iframe width="100%" height="500px" src="https://<%= MultiSchool.current_school.code %>.classtune.com<%= @assignment_answer.attachment.url %>&embedded=true&print=true" style="border:0px;"   frameborder="0" ></iframe>
      <% end %>   
  <% end %>
  

  <div class="answer-details">
    <div class="label-div-pair"><label for="student-name"><%= "#{t('submitted_by')}"%></label><div id="student-name" class="themed_text"> <%= @assignment_answer.student_details.present? ? @assignment_answer.student_details.full_name : t('no_students') %></div></div>
    <% time_created = @assignment_answer.created_at.to_time + 6*60*60 %>  
    
    <div class="label-div-pair"><label for="submitted-date"><%= "#{t('submitted_on')}"%> </label><div id="submitted-date" class="themed_text"><%= I18n.l(time_created, :format=>'%I:%M %p, %d %B, %Y') %></div></div>
    <% if @current_user.student? %>
      <% if @current_user.student_record.id == @assignment_answer.student_id %>
        <div class="label-div-pair"><label for="answer-status"><%= "#{t('status')}"%></label>
          <div id="answer-status" class="themed_text">
            <% if @assignment_answer.status == "0"  %>
              <%= "#{t('this_answer_yet_to_be_evaluated')}"%>
            <% else %>
              <%= "#{t('the_assignment_is')}"%>  <%= @assignment_answer.status.capitalize   %> <%=  link_to  "(#{t('resubmit_answer')})" ,  edit_assignment_assignment_answer_path(@assignment,@assignment_answer)  unless @assignment_answer.status=="ACCEPTED"%>
            <% end %>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>
  <div id="evaluate-answer">
   
      <% if @current_user.employee_record.id == @assignment_answer.assignment.employee_id or @current_user.admin? %>
        <% unless @assignment_answer.status=="ACCEPTED" %>  <%= link_to "#{t('accept_answer')}",  {:action => "evaluate_assignment" ,:id=>@assignment_answer.id,:status=>"ACCEPTED"},:class=>"submit-button" %><% end %>
        <% unless @assignment_answer.status=="REJECTED" %>  <%= link_to "#{t('reject_answer')}",  { :action => "evaluate_assignment" ,:id=>@assignment_answer.id,:status=>"REJECTED" },:class=>"submit-button" %><% end %>
        <% if @assignment_answer.status!="ACCEPTED" %>  <%= link_to "Delete Answer",  {:action => "evaluate_assignment" ,:id=>@assignment_answer.id,:status=>"DELETED"},:class=>"submit-button" %><% end %>
      <% end %>
  </div>
  
    <% if @assignment.total_mark.to_i > 0 %>
      <% form_remote_for :assignment_answer, :id => 'mark-form', :url => { :action => 'add_mark' },  :loading => "$('loader2').show();$('success_msg').hide();$('mysubmit2').disable();", :loaded => "$('loader2').hide();$('success_msg').show();$('mysubmit2').enable();" do |m| %>
        <h4 id="leave-a-comment">Assignment Mark</h4>
       <div>
           <p><b style="color:green; display: none" id="success_msg">Success Fully Saved</b></p>
         <%= image_tag("loader.gif",
            :align => "absmiddle",
            :border => 0,
            :id => "loader2",
            :style =>"display: none;" ) %>
         <%= m.hidden_field :assignment_answer_id, :value => @assignment_answer.id %>
        <div class="comment-content"> <%= m.text_field :mark, :value => @assignment_answer.mark %> </div> 
        <div id="submit-button"><%= submit_tag '', {:value =>"Save",:onClick => "return validate()",:id => "mysubmit2"} %></div>
       </div>    
      <% end %> 
    <% end %> 
    <% if MultiSchool.current_school.id == 2 %>
    <h4 id="leave-a-comment"><%= t('leave_comment') %>   <%= image_tag("loader.gif",
        :align => "absmiddle",
        :border => 0,
        :id => "loader",
        :style =>"display: none;" ) %></h4>

    <% form_remote_for :comment, :id => 'comments-form', :url => { :action => 'add_comment' },  :loading => "$('loader').show();$('mysubmit').disable();", :loaded => "$('loader').hide();$('mysubmit').enable();" do |f| %>
      <div class="comment-content"> <%= f.text_area :content %> </div>
      <%= f.hidden_field :student_id, :value => @assignment_answer.student_id %>
      <%= f.hidden_field :assignment_id, :value => @assignment_answer.assignment_id %>
      <div id="submit-button"><%= submit_tag '', {:value =>"#{t('submit')}",:onClick => "return validate()",:id => "mysubmit"} %></div>
    <% end %>
    <div class="extender"></div>
   
    
    <h3 id="comments-heading"><%= t('comments') %>
     <%= image_tag("loader.gif",
        :align => "absmiddle",
        :border => 0,
        :id => "loader2",
        :style =>"display: none;" ) %></h3>
    <ul id="comments-list">
      <%= render :partial => "comment" %>
    </ul>
    
   <% end %> 
  
  
</div>
</div>
  </div>
    </div>
<style>
  .box_content
{
    background:#ffffff;
    width: 100%;
    float:left;
   
}
.partial_homework
{
    clear: both;
}
.partial_homework h2 {
  color: #2dc99a;
  float: left;
  font-size: 38px;
  font-weight: normal;
  margin: 0;
}
 


#comments-heading{border-bottom:2px solid gray;padding:0 0 10px}
#leave-a-comment{margin:40px 0 10px}
#comments-list{padding:0 0 20px}
#comments-list li{border-bottom:1px solid #aaa;list-style-type:none;margin:20px 0 0;padding:10px 0}
#comments-list li .comment-details{color:#888;font-size:80%;height:15px;margin:0 0 10px}
.comment-details .commenter{float:left;width:535px}
.comment-details .comment-posted-at{float:right;padding-left:10px}
.comment-details .delete-comment{float:right;margin:0 0 0 20px}
.comment-content{width:600px}
.comment-content textarea{-moz-border-radius:10px 10px 10px 10px;-webkit-border-radius:10px;border:1px solid #c6c6c6;background-color:#eee;width:600px;height:100px;padding:10px}
.comment-content textarea:focus{background:#fff;border:1px solid #9e0f15}
#submit-button{margin:20px 0 0}
#submit-button input{-moz-border-radius:10px;-webkit-border-radius:10px;background:#db3434 none repeat scroll 0 0;color:#fff;font-size:14px;font-weight:700;margin:0 auto;padding:7px 12px;border:none;float:left;text-align:center;width:auto;cursor:pointer;margin-left:510px}
.approve{float:left;width:220px}
.delete-comment a{color:#000;font-size:12px;font-weight:400;margin-bottom:10px;text-decoration:none}
.approve a{color:#000;font-size:12px;font-weight:400;margin-bottom:10px;text-decoration:none}
.pagination{margin-top:15px;margin-right:0}
</style>