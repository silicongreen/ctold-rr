<%-# Champs21
#Copyright 2010 teamCreative Private Limited
#
#This product includes software developed at
#Project Champs21 - http://www.champs21.com/
#
#Licensed under the Apache License, Version 2.0 (the "License");
#you may not use this file except in compliance with the License.
#You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
#Unless required by applicable law or agreed to in writing,
#software distributed under the License is distributed on an
#"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
#KIND, either express or implied.  See the License for the
#specific language governing permissions and limitations
#under the License. -%>

<div id="content-header">
<%= show_header_icon %>
  <h1><%= t('online_payment') %></h1>
<div class='header-sep'>|</div>
<div class='sub-header'><%= t('settings') %></div>

<div id="inner-tab-menu">
  <ul>
    <li class='themed_bg themed-dark-hover-background'><%= link_to "Transaction", transactions_online_payments_path %></li>
  </ul>
</div>

</div>
<div id="page-yield">
  <% unless flash[:notice].nil? %>
    <p class="flash-msg"> <%= flash[:notice] %> </p>
  <% end %>

  <% form_for :payment_settings,:url => {:action => :settings} do |f| %>
    <div class="label-field-pair-gateway">
      <label for="configuration_fee"><%= t('include_fees') %></label>
      <% allowed_module = ["Student Fee"]
      if Champs21Plugin.accessible_plugins.include? "champs21_applicant_registration"
        allowed_module = allowed_module.push("Application Registration")
      end
      if Champs21Plugin.accessible_plugins.include? "champs21_hostel"
        allowed_module = allowed_module.push("Hostel Fee")
      end
      if Champs21Plugin.accessible_plugins.include? "champs21_transport"
        allowed_module = allowed_module.push("Transport Fee")
      end
    %>
      <div class="check_box_group">
        <% allowed_module.each do |fee| %>
          <div class="value">
            <%= check_box_tag "payment_settings[enabled_fees][]",fee, (@enabled_fees.include? fee),:id => "checkbox_#{fee}" %>
            <label for="configuration_<%= fee.underscore %>"><%= fee %></label>
          </div>
        <% end %>
      </div>
    </div>


    <div class="label-field-pair-gateway" style="height: auto; padding-bottom: 10px; border-bottom: 0px;">
      <label for="student_grade"><%= t('gateway') %></label>
      <%= image_tag("loader.gif",:align => "absmiddle",:border => 0,:id => "loader", :style =>"display: none;" ) %>
      <div class="value" style="max-width: 75%; width: 75%; float: left;">
        <% Champs21Pay::GATEWAYS.each do |gateway| %>
          <div style="width: 49%;float: left;">
            <div style="float: left; width: 5%;">
            <%= radio_button("payment_settings","champs21_gateway",gateway,{:checked => @active_gateway == gateway,:onchange => "#{remote_function(:url => {:controller => "payment_settings",:action => "show_gateway_fields",:gateway => gateway},
                :before => "Element.show('loader')",
                :success => "Element.hide('loader')")}"}) %>
            </div>    
            <div style="float: left; width: 90%;">
            <%= image_tag "/images/gateway_images/#{gateway}.png", :class => "gateway_image" %>
            </div>
          </div>
        <% end %>
      </div>
    </div>

    <div id ="gateway_fields">
      <%= render :partial => "gateway_fields" %>
    </div>
  <% end %>
</div>

<style>
    .gateway_image{
      border: 1px solid #ccc;
    }
</style>
