 <% total_credit_points=0 %>
  <% total_credit_hours=0 %>
<div class="CSSTableGenerator" >
          <table id="listing" class="f5" align="center" width="100%" cellpadding="1" cellspacing="1">
              <thead>
                  <tr class="tr-head">

                      <th><%= t('subject_title') %></th>
                      <th  <%= allcss %>><%= t('grade') %></th>
                      <th  <%= allcss %>><%= t('marks') %></td>
                      <th  <%= allcss %>><%= "Highest" %></td>
                      <th  <%= allcss %>><%= "Total" %></td>




                      <th  <%= allcss %>>%</th>
                      <td><%= t('remarks') %></td>

                  </tr>
              </thead>
              <% j = 0; %>
              <% total_mark = 0 %>
              <% cradit_point = 0 %>
              <% total_mark_with_no_exam = 0 %>
              <% cradit_point_with_no_exam = 0 %>
              <% exam_score.each do |es| %>
                <%
                extra_colspan = ""
                css = ""
                add_mark = true
                if es.exam.subject.no_exams
                  css = "style='display:none'"
                  extra_colspan = "colspan = '10'"
                  add_mark = false
                  end
              %>
                <tr >



                    <td > <%= es.exam.subject.name %></td>
                    <td  <%=css%>>

                        <%= "#{es.grading_level.present? ? es.grading_level : " "}"+"#{es.grading_level.present? ? (es.grading_level.credit_points.present? ?  " ["+"#{es.grading_level.credit_points }"+"]"  : " ") : " "}" %></td>
                    <% 
                    if es.grading_level.present? 
                      if es.grading_level.credit_points.present?
                        cradit_point = cradit_point.to_f+es.grading_level.credit_points.to_f 
                      end
                      end
                  %>

                    <td  <%=css%>><%= es.marks.present? ? mark=es.marks.to_f : '-' %></td>
                    <% 
                    if es.marks.present? and  add_mark
                      total_mark = total_mark.to_f+es.marks.to_f 
                      end
                    if es.marks.present? 
                      total_mark_with_no_exam = total_mark_with_no_exam.to_f+es.marks.to_f 
                      end  
                  %>
                    <td  <%=css%>> <%=  max_mark[j] %></td>
                    <td  <%=css%>><%= es.exam.maximum_marks.to_f %></td>

                    <td  <%=css%>>

                        <%
                        if es.marks.present?
                          mark=(es.marks.to_f/es.exam.maximum_marks.to_f)*100 
                          else
                          mark = 0
                          end  


                      %>
                        <% if mark>0 %>
                          <%= sprintf( "%0.02f", mark) %> %
                        <% end %>




                    </td>
                    <% if add_mark %>
                      <% total_credit_hours = total_credit_hours + es.exam.subject.credit_hours.to_f %>
                      <% points=0 %>
                      <% points = (es.grading_level.credit_points.to_f) * (es.exam.subject.credit_hours.to_f) if es.grading_level.present? %>

                      <% total_credit_points = total_credit_points + points %>
                    <% end %>
                    <td class="col-1" <%= extra_colspan %>><%= es.remarks %></td>

                </tr>
                <% j = j+1; %>  
              <% end %>


          </table>
      </div> 

      <% if MultiSchool.current_school.id == 324 %>
      <div class="user_button" style="margin:10px 0px;   margin-left: 27px;">
          <%= link_to "#{t('pdf_report')}", {:controller => "exam", :action => "student_wise_generated_report", :student=>@student.id,:exam_group=>@exam_group.id},:target => '_blank' %>
      </div>
      <% end %>