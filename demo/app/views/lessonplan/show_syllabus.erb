<%-# Champs21
#Copyright 2010 teamCreative Private Limited
#
#This product includes software developed at
#Project Champs21 - http://www.champs21.com/
#
#Licensed under the Apache License, Version 2.0 (the "License");
#you may not use this file except in compliance with the License.
#You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
#Unless required by applicable law or agreed to in writing,
#software distributed under the License is distributed on an
#"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
#KIND, either express or implied.  See the License for the
#specific language governing permissions and limitations
#under the License. -%>

<div id="content-header">
<%= show_header_icon %>
  <h1><%= t('school_syllabus') %></h1>

<div id="inner-tab-menu">
  <ul>
    <li class='themed_bg themed-dark-hover-background'><%= link_to "#{t('view_all')}", :controller => 'syllabus', :action => 'all' %></li>
    <% if permitted_to? :add,:syllabus %>
      <% if @is_class %>
        <li class='themed_bg themed-dark-hover-background'><%= link_to t('new'), {:controller => "syllabus", :action => 'new', :batch_id => @batch.id, :batch_name => @batch_name, :course_name => @course.course_name ,:class=> @is_class},:target => "_blank"  %>            </li>      
      <% else %>
        <li class='themed_bg themed-dark-hover-background'><%= link_to t('new'), {:controller => "syllabus", :action => 'new', :batch_id => @batch.id, :batch_name => @batch_name },:target => "_blank"  %>            </li>      
      <% end %>
    <% end %>
  </ul>
</div>
</div>
<div id="page-yield">
  <div class="box">
    <div class="f2" style="float: left;">        
      <% if @batch.name != "General" %>      
        <%="Shift" %> : <%= @batch.name  %><br />
      <% end  %>
      <%="Class" %> : <%=@course.course_name %><br />
      <% if @is_class and @batch_name %>

      <% else %>
        <%="Section" %> : <%=@course.section_name %><br /><br />
      <% end %>
    </div><br /><br /><br />
    <!--<div class="label-field-pair">
      <label for="student_course"><%#= t('select_a_batch') %>:
        <%#= image_tag("loader.gif",:align => "absmiddle",:border => 0,:id => "loader", :style =>"display: none;" ) %>
      </label>
      <div class="text-input-bg">
        <%#= select :batch, :id,
          @batches.map {|b| [b.full_name, b.id] },
          {:prompt => t('select_a_batch')},
          {:onchange => "#{remote_function(
          :url => { :action => 'showall' },
          :with => "'batch_id='+value",
          :before => "Element.show('loader')",
          :success => "Element.hide('loader')"  )}"} %>
      </div></div>-->

  <% unless @syllabus.empty? %>
  <ul id="category-list">

    <% @syllabus.each do |syllabus| %>
    <% link_value = syllabus.title %>  
    <li id="subject-<%= syllabus.id %>" class="list<%= cycle('even','odd')%>" >
        <div class="category-name">
<%=  link_to link_value, {:controller => 'syllabus', :action => 'view', :id => syllabus.id},:target => "_blank"%>
        </div>
        <div class="opt">
          <div class="category-code"><% @subject= Subject.find(syllabus.subject_id) %><%= @subject.name  %></div>
          <div class="category-edit"><%= link_to t('edit_text'), {:controller => 'syllabus', :action => 'update', :id => syllabus.id},:target => "_blank" %></div>
          <div class="category-delete">
            <% @subject_exams= Exam.find_by_subject_id(syllabus.id) %>
            <% @subject_timetable = TimetableEntry.find_all_by_subject_id(syllabus.id) %>
            <% if @subject_exams.blank? and @subject_timetable.blank?%>
             <%= link_to_remote(t('delete_text'),
                :url => subject_path(syllabus),
                :method => 'delete',
                :confirm => t('delete_confirm_msg'),
                :update => "syllabus-#{syllabus.id}") %>
            <% else %>
              <s><%= t('delete_text') %></s>
            <% end %>
          </div>

        </div>
      </li>
    <% end %>
  </ul>
<% end %>



  </div></div>

